<view class="mine-container">
  <view class="bg-white" style="padding-top: {{statusBarHeight + menuButtonHeight}}px;"></view>
  <view class="header" style="padding-top: {{statusBarHeight}}px; line-height: {{menuButtonHeight}}px;">
    <iconfont icon="setting" class="text-grey1 f-s-20" bindtap="toSetting"></iconfont>
  </view>
  <view class="user-info-content">
    <view class="employee-info" wx:if="{{!!employeeInfo}}">
      <!-- 展示系统头像 -->
      <view class="thumbnail">
        <image wx:if="{{employeeInfo.gender}}" src="{{userSexIcon[employeeInfo.gender]}}" lazy-load="true" />
        <image wx:else src="{{userSexIcon.default}}" lazy-load="true" />
      </view>
      <!-- 微信接口登录调整，此版本适用于2.21.2的基础库，暂时不使用微信头像 -->
      <!-- <view class="wx-avatar">
        <button class="avatar-wrapper" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
          <image class="avatar" src="{{avatarUrl}}"></image>
        </button>
      </view> -->
      <view class="d-flex align-items-center justify-content-center">
        <view class="f-s-16 f-w-bold m-r-8">
          {{employeeInfo.surnameCn}}{{employeeInfo.givenNameCn}}
        </view>
        <view class="f-s-14" wx:if="{{!isSK}}">{{employeeInfo.departmentName}}</view>
      </view>
      <view class="m-t-4 d-flex align-items-center justify-content-center" bindtap="handleShowRoleSheet">
        <view class="f-s-14 m-r-8">{{employeeInfo.corpName}}</view>
        <iconfont icon="arrow-right" class="f-s-12"></iconfont>
      </view>
      <view wx:if="{{invitationCount}}" class="invitation-tips d-flex align-items-center justify-content-sp-bw" bindtap="handleShowInvitations">
        <view class="d-flex align-items-center">
          <image src="{{tipIcon}}" class="tip-icon" />
          {{invitationCount}}家公司邀请您加入，
          <view class="text-underline">点击去处理</view>
        </view>
        <iconfont icon="arrow-right" class="f-s-10"></iconfont>
      </view>
    </view>
    <view class="logged-out" wx:else>
      <view class="tips">登陆特航商旅开启旅程</view>
      <view class="login-btn" bindtap="toLogin">登录/注册</view>
    </view>
    <!-- todo 这里的微信信息展示以及微信授权登录暂时隐藏 -->
    <!-- <view class="wx-info" wx:else>
      <view class="wx-avatar">
        <open-data class="avatar" type="userAvatarUrl"></open-data>
      </view>
      <view>
        <open-data type="userNickName" lang="zh_CN"></open-data>
      </view>
      <view class="auth-content">
        <button class="auth-btn" open-type="getPhoneNumber" bindgetphonenumber="bindGetPhoneNumber">
          微信手机号登录
        </button>
        <button class="auth-btn" bindtap="toLogin">特航登录</button>
      </view>
    </view> -->
  </view>
  <view class="order-content">
    <view class="nav" bindtap="toOrders" data-category="">
      <view class="title">我的订单</view>
      <view class="suffix">
        <view class="m-r-8">全部订单</view>
        <iconfont icon="arrow-right f-s-12"></iconfont>
      </view>
    </view>
    <view class="order-operate-list">
      <view class="item" bindtap="toOrders" data-category="UnPaid">
        <image class="order-icon" src="{{OrderStatusIcon.unpaid}}" lazy-load="true" />
        <view>待付款</view>
      </view>
      <view class="item" bindtap="toOrders" data-category="Processing">
        <image class="order-icon" src="{{OrderStatusIcon.processing}}" lazy-load="true" />
        <view>处理中</view>
      </view>
      <view class="item" bindtap="toOrders" data-category="ToTravel">
        <image class="order-icon" src="{{OrderStatusIcon.toTravel}}" lazy-load="true" />
        <view>待出行</view>
      </view>
      <view class="item" bindtap="toOrders" data-category="RefundOrCancel">
        <image class="order-icon" src="{{OrderStatusIcon.cancelled}}" lazy-load="true" />
        <view>退款/取消</view>
      </view>
    </view>
  </view>
  <view class="nav-list-content" wx:if="{{!isSK}}">
    <van-cell title="差旅政策" title-class="cell-title" bindtap="toTravelPolicy">
      <iconfont class="title-icon" icon="policy" slot="icon"></iconfont>
      <iconfont class="text-grey2 f-s-12" icon="arrow-right" slot="right-icon"></iconfont>
    </van-cell>
  </view>
  <view class="nav-list-content">
    <van-cell title="常用信息" title-class="cell-title" bindtap="toEmployeeInfoManagement">
      <iconfont class="title-icon" icon="general" slot="icon"></iconfont>
      <iconfont class="text-grey2 f-s-12" icon="arrow-right" slot="right-icon"></iconfont>
    </van-cell>
    <van-cell title="我的积分" title-class="cell-title" bindtap="toPointDetail">
      <iconfont class="title-icon" icon="point" slot="icon"></iconfont>
      <iconfont class="text-grey2 f-s-12" icon="arrow-right" slot="right-icon"></iconfont>
    </van-cell>
    <van-cell title="用户协议" title-class="cell-title" bindtap="toUserProtocol">
      <iconfont class="title-icon" icon="document" slot="icon"></iconfont>
      <iconfont class="text-grey2 f-s-12" icon="arrow-right" slot="right-icon"></iconfont>
    </van-cell>
  </view>
  <view class="nav-list-content">
    <van-cell title="联系客服" title-class="cell-title" bindtap="handleMakePhoneCall">
      <iconfont class="title-icon" icon="servicer" slot="icon"></iconfont>
      <iconfont class="text-grey2 f-s-12" icon="arrow-right" slot="right-icon"></iconfont>
    </van-cell>
    <van-cell title="意见反馈" title-class="cell-title" bindtap="toFeedback">
      <iconfont class="title-icon" icon="edit" slot="icon"></iconfont>
      <iconfont class="text-grey2 f-s-12" icon="arrow-right" slot="right-icon"></iconfont>
    </van-cell>
  </view>
</view>
<!-- 身份切换sheet -->
<van-action-sheet show="{{ showRoleSheet }}" title="切换身份" bind:close="handleCloseRoleSheet" bind:click-overlay="handleCloseRoleSheet">
  <view class="roles-list-content">
    <block wx:for="{{rolesActions}}" wx:key="employeeId">
      <view class="role-item {{item.employeeId === employeeInfo.id ? 'selected' : ''}}" data-id="{{item.employeeId}}" bindtap="handleSelectRole">
        <view class="text-ellipsis text-center">{{item.name}}</view>
        <iconfont icon="selected" wx:if="{{item.employeeId === employeeInfo.id}}"></iconfont>
      </view>
    </block>
  </view>
</van-action-sheet>
<!-- 邀请处理弹窗 -->
<block wx:if="{{invitationCount}}">
  <invitations-popup showPopup="{{showInvitations}}" bind:close="getAllInvitationsCount"></invitations-popup>
</block>
<!-- 自定义loading -->
<loading wx:if="{{isLoading}}" title="{{loadingTitle}}" />
<!-- 底部自定义菜单 -->
<tab-bar active="{{tabBarIndex}}"></tab-bar>