exports.ids=[0],exports.modules={1046:function(e,t,r){e.exports=r.p+"components/route-link/index.json"},1047:function(e,t,r){e.exports=r.p+"components/route-link/index.wxml"},1048:function(e,t,r){e.exports=r.p+"components/route-link/index.wxss"},1049:function(e,t,r){e.exports=r.p+"components/icon-iconfont/index.json"},1050:function(e,t,r){e.exports=r.p+"components/icon-iconfont/index.wxml"},1051:function(e,t,r){e.exports=r.p+"components/icon-iconfont/index.wxss"},1052:function(e,t,r){e.exports=r.p+"components/icon-iconfont-colorful/index.json"},1053:function(e,t,r){e.exports=r.p+"components/icon-iconfont-colorful/index.wxml"},1054:function(e,t,r){e.exports=r.p+"components/icon-iconfont-colorful/index.wxss"},1055:function(e,t,r){e.exports=r.p+"components/dict-transform/index.json"},1056:function(e,t,r){e.exports=r.p+"components/dict-transform/index.wxml"},1057:function(e,t,r){e.exports=r.p+"components/dict-transform/index.wxss"},1058:function(e,t,r){e.exports=r.p+"components/date-format/date-format.json"},1059:function(e,t,r){e.exports=r.p+"components/date-format/date-format.wxml"},1060:function(e,t,r){e.exports=r.p+"components/date-format/date-format.wxss"},1061:function(e,t,r){e.exports=r.p+"components/number-encrypt/number-encrypt.json"},1062:function(e,t,r){e.exports=r.p+"components/number-encrypt/number-encrypt.wxml"},1063:function(e,t,r){e.exports=r.p+"components/number-encrypt/number-encrypt.wxss"},1064:function(e,t,r){e.exports=r.p+"components/loading/loading.json"},1065:function(e,t,r){e.exports=r.p+"components/loading/loading.wxml"},1066:function(e,t,r){e.exports=r.p+"components/loading/loading.wxss"},1067:function(e,t,r){e.exports=r.p+"components/teh-input/teh-input.json"},1068:function(e,t,r){e.exports=r.p+"components/teh-input/teh-input.wxml"},1069:function(e,t,r){e.exports=r.p+"components/teh-input/teh-input.wxss"},1070:function(e,t,r){e.exports=r.p+"components/teh-image/teh-image.json"},1071:function(e,t,r){e.exports=r.p+"components/teh-image/teh-image.wxml"},1072:function(e,t,r){e.exports=r.p+"components/teh-textarea/teh-textarea.json"},1073:function(e,t,r){e.exports=r.p+"components/teh-textarea/teh-textarea.wxml"},1074:function(e,t,r){e.exports=r.p+"components/teh-textarea/teh-textarea.wxss"},1136:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),a=r(8),s=r(6),c=r(0),l=r(123),u=r(72),p=r(801),h=function(){function e(e,t,r,o,i,n,a,s,c){this.data=e,this.globalData=t,this.approvalMixedService=r,this.tokenService=o,this.loginService=i,this.invitationsService=n,this.routerService=a,this.approvalHttpService=s,this.authorizeHttpService=c}var t=e.prototype;return t.onLoad=function(){var e=this;this.wechatLogin(),this.globalData.getEmployeeInfoChanged().subscribe(function(){e.initEmployeeInfo()})},t.assertLogin=function(){var e=this,t=this.isLogin();return t||(wx.showToast({title:"请先进行登录！",icon:"none"}),setTimeout(function(){e.routerService.toAuthorizeLogin()},500)),t},t.handleToLogin=function(){this.routerService.toAuthorizeLogin()},t.wechatLogin=function(){var e=this.loginService.getLastLoginScene();this.isLogin()&&e===u.LoginScene.VerificationCode?this.loginService.loginByLastToken():this.loginService.wechatLogin()},t.onShow=function(){this.isLogin()&&this.getAllInvitationsCount()},t.getTabBarAuthorize=function(){var e=this;this.approvalMixedService.getApprovalAndAuthorizeEnabled().subscribe(function(t){e.setData({tabBarIndex:0});var r=t.approvalEnabled,o=t.authorizeEnabled;(r||o)&&e.getApprovalAndAuthorizeToAuditNumber()})},t.getAllInvitationsCount=function(){var e=this;this.invitationsService.getAllInvitationsCount().subscribe(function(t){e.setData({showInvitations:!!t})})},t.initEmployeeInfo=function(){var e=this.globalData.getUserInfo();this.setData({employee:e}),e&&this.getTabBarAuthorize()},t.getApprovalAndAuthorizeToAuditNumber=function(){var e=this;this.approvalHttpService.getApprovalAndAuthorizeToAuditNumber().subscribe(function(t){var r=t.approvalToAuditNum,o=t.authorizeToAuditNum;r&&e.getApprovalList(r),o&&e.getAuthList(o)})},t.getApprovalList=function(e){var t=this;this.approvalHttpService.getApprovalToAuditPageList({waitingAudited:!0,pageSize:e}).subscribe(function(e){t.setData({approvalList:e.content||[]})})},t.getAuthList=function(e){var t=this;this.authorizeHttpService.getAuthorizeSheetToAuditPageList({authorizeSheetHandleStatus:"WaitHandle",pageSize:e}).subscribe(function(e){t.setData({authorizeList:e.content||[]})})},t.isLogin=function(){return!!this.tokenService.getToken()},t.throttleToHotelSearch=function(){this.assertLogin()&&this.routerService.hotel.toSearch()},t.throttleToFlightSearch=function(){this.assertLogin()&&this.routerService.flight.toSearch()},e}();h=o([c.injectable(),i("design:paramtypes",[function(){this.banners=[p],this.tabBarIndex=0,this.showInvitations=!1,this.approvalList=[],this.authorizeList=[],this.today=s.DateUtils.format(new Date,"yyyy年MM月dd日")},a.GlobalDataService,l.ApprovalMixedService,a.TokenService,u.LoginService,a.InvitationsService,a.RouterService,n.ApprovalHttpService,n.AuthorizeHttpService])],h),Page(c.container.resolve(h))},1145:function(e,t,r){"use strict";function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var a=r(79),s=r(8),c=r(6),l=r(303),u=r(32),p=r(16),h=r(5),f=r(0),d=r(22),v=r(124),m=r(171),g=r(125),y=r(317),b=function(){function e(){this.checkboxIcons={checked:c.OSSPrefix+"/common/checked.svg",unchecked:c.OSSPrefix+"/common/unchecked.svg"},this.travelTypes=d.TravelType,this.travelType=d.TravelType.OnBusiness,this.calenderVisible=!1,this.formatter=function(e){return"start"===e.type?e.bottomInfo="入住":"end"===e.type&&(e.bottomInfo="离店"),e},this.maxdate=l.DateUtils.addYears(new Date,1).valueOf(),this.pricePickerVisible=!1,this._minPrice=g.sliderMin,this._maxPrice=g.sliderMax,this.priceItems=g.getPriceItems(),this.showInvitations=!1}var t,r,i;return t=e,(r=[{key:"isOnBusiness",get:function(){return this.travelType===d.TravelType.OnBusiness}},{key:"totalDays",get:function(){var e=this.formData;if(e){var t=e.checkInDate,r=e.checkOutDate;if(t)return l.DateUtils.differenceInDays(r,t)}return""}},{key:"calendarDefaultDate",get:function(){var e=this.formData;if(!e)return null;var t=e.checkInDate,r=e.checkOutDate;return[new Date(l.DateUtils.format(t)).valueOf(),new Date(l.DateUtils.format(r)).valueOf()]}},{key:"priceRangeDesc",get:function(){var e=this.formData;return g.getPriceRangeDesc(e)}},{key:"priceRangeDescInPopup",get:function(){var e=this._minPrice,t=this._maxPrice;return g.getSliderRangeDesc(e,t)}}])&&o(t.prototype,r),i&&o(t,i),e}(),S=function(){function e(e,t,r,o,i,n){this.data=e,this.hotelCityHttpService=t,this.chooseCityService=r,this.conditionService=o,this.handleErrorService=i,this.validateService=n,this.sliderValue$=new p.Subject}var t=e.prototype;return t.onLoad=function(){this.initSearchForm()},t.initSearchForm=function(){var e=this;this.form=y.createForm();var t=this.form;t.valueChanges.pipe(h.startWith(t.value)).subscribe(function(t){var r=e.data.formData;c.ObjectUtils.deepCompare(r,t)||e.setData({formData:t})}),t.statusChanges.pipe(h.startWith(t.status)).subscribe(function(r){var o=e.validateService.getErrorMsgs(t),i=e.data.errMsgs;c.ObjectUtils.deepCompare(i,o)||e.setData({errMsgs:o})});var r=new Date,o=l.DateUtils.addDays(r,1);t.patchValue({checkInDate:l.DateUtils.format(r),checkOutDate:l.DateUtils.format(o)}),this.sliderValue$.pipe(h.debounceTime(50)).subscribe(function(t){var r=t[0],o=t[1];e.setData({_minPrice:r,_maxPrice:o})}),this.initLocationCity()},t.initLocationCity=function(){var e=this;wx.showLoading({title:"加载中"}),p.of({address_component:{city:"深圳"}}).pipe(h.switchMap(function(t){return e.processWithCityInfo(t)}),h.finalize(function(){return wx.hideLoading()})).subscribe(this.processAddressResult)},t.processWithCityInfo=function(e){var t=this,r=e.address_component.city;return this.cityName=r.replace(/市/,""),this.hotelCityHttpService.getAllCity().pipe(h.map(function(r){return{city:r.cities.find(function(e){return e.name===t.cityName}),address:e}}))},t.processAddressResult=function(e){var t=e.city,r=e.address,o=r.location,i=r.formatted_addresses,n=t.code,a=t.name;i&&(a+=" "+i.recommend);this.setData({addressDetail:a});var s={cityCode:n};if(o){var c=o.lat,l=o.lng;s.condition={coordinates:{lat:c,lon:l}}}this.form.patchValue(s)},t.throttleLocateCurrentAddress=function(){var e=this;this.getCurrentAddress().pipe(h.catchError(function(t){return t instanceof s.WeAPIError&&"getLocation"===t.code?g.openSetting().pipe(h.switchMap(function(t){return e.getCurrentAddress()})):e.handleErrorService.handle(t)})).subscribe(this.processAddressResult)},t.getCurrentAddress=function(){var e=this;return wx.showLoading({title:"加载中"}),p.of({address_component:{city:"深圳"}}).pipe(h.switchMap(function(t){return e.processWithCityInfo(t)}),h.finalize(function(){return wx.hideLoading()}))},t.throttleChangeTravelType=function(e){var t=e.currentTarget.dataset.type;this.setData({travelType:t})},t.throttleChooseCity=function(){var e=this;this.chooseCityService.getCity().subscribe(function(t){var r=t.code,o=t.name;e.data.formData.condition.position&&e.setData({keyword:null}),e.form.patchValue({cityCode:r,condition:{coordinates:{lat:null,lon:null}}}),e.setData({addressDetail:o})})},t.throttleChooseDate=function(){this.setData({calenderVisible:!0})},t.throttleDateClose=function(){this.setData({calenderVisible:!1})},t.throttleDateConfirm=function(e){var t=e.detail,r=t[0],o=t[1];r=l.DateUtils.format(r),o=l.DateUtils.format(o),this.form.patchValue({checkInDate:r,checkOutDate:o}),this.setData({calenderVisible:!1})},t.throttleChooseCondition=function(){var e=this,t=this.getParams();this.conditionService.getCondition(t).subscribe(function(t){var r=t.conditions,o=t.desc;e.form.patchValue(r),e.setData({keyword:o})})},t.throttleClearCondition=function(){this.setData({keyword:null}),this.form.patchValue(Object.assign({},v.getEmptyConditions()))},t.throttleChoosePrice=function(){this.setData({pricePickerVisible:!0})},t.throttlePricePickerClose=function(){this.setData({pricePickerVisible:!1})},t.handlePriceDrag=function(e){this.sliderValue$.next(e.detail.value)},t.throttlePriceConfirm=function(){var e=this.data,t=e._minPrice,r=e._maxPrice,o=g.getSliderValue(t,r);this.form.patchValue({condition:{priceRanges:o}}),this.setData({pricePickerVisible:!1})},t.throttlePriceClear=function(){this.form.patchValue({condition:{priceRanges:[{priceFrom:null,priceTo:null}]}}),this.setData({pricePickerVisible:!1,_minPrice:g.sliderMin,_maxPrice:g.sliderMax})},t.throttleChoosePriceItem=function(e){var t=e.currentTarget.dataset.price,r=t.min||0,o=t.max;this.setData({_minPrice:r,_maxPrice:o})},t.throttleSearch=function(){if(c.FormUtils.validate(this.form)){var e=this.getParams(),t=JSON.stringify(e);wx.navigateTo({url:"/app/pages/hotel/display/display?params="+t})}else this.form.updateValueAndValidity()},t.getParams=function(){var e=this.data,t=e.formData,r=e.travelType,o=c.removeEmpty(Object.assign({},t,{travelType:r,cityName:this.cityName}));return Object.assign({},o,{travelType:r})},t.onShareAppMessage=function(){return{title:"特航商旅酒店预订"}},e}();S=i([f.injectable(),n("design:paramtypes",[b,a.FrontHotelCityHttpService,m.ChooseCityService,v.ConditionService,s.HandleErrorService,u.ValidateService])],S);var D=f.container.resolve(S);Page(D)},1146:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),a=r(8),s=r(50),c=r(6),l=r(5),u=r(22),p=r(0),h=r(123),f=r(72),d=function(){function e(e,t,r,o,i,n,a,s,c,l,p){this.data=e,this.tokenService=t,this.toastService=r,this.routerService=o,this.handleErrorService=i,this.globalDataService=n,this.employeeRoleHttpService=a,this.invitationsService=s,this.commonHttpService=c,this.approvalMixedService=l,this.loginService=p,this.corpNameOps={[u.CorpType.SK]:"特航个人会员",[u.CorpType.GovernmentSK]:"公务员个人会员",[u.CorpType.Corporation]:"",[u.CorpType.Government]:""}}var t=e.prototype;return t.onLoad=function(){var e=this;wx.getSystemInfo({success:function(t){var r=wx.getMenuButtonBoundingClientRect();e.setData({statusBarHeight:t.statusBarHeight,menuButtonHeight:2*(r.top-t.statusBarHeight)+r.height})}}),this.init(),this.globalDataService.getEmployeeInfoChanged().subscribe(function(t){var r=e.globalDataService.getGlobalData().employeeInfo;r&&(e.handleEmployeeInfo(r),e.getTabBarAuthorize())})},t.onShow=function(){this.tokenService.getToken()&&this.getAllInvitationsCount()},t.init=function(){this.getEmployeeInfo(),this.getTabBarAuthorize(),this.getAllInvitationsCount()},t.getTabBarAuthorize=function(){var e=this;this.approvalMixedService.getApprovalAndAuthorizeEnabled().subscribe(function(t){var r=t.approvalEnabled,o=t.authorizeEnabled;e.setData({tabBarIndex:r||o?2:1})})},t.getAllInvitationsCount=function(){var e=this;this.invitationsService.getAllInvitationsCount().subscribe(function(t){e.setData({invitationCount:t})})},t.getEmployeeInfo=function(){var e=this;this.showLoading(),this.loginService.getEmployeeInfoRequest().pipe(l.finalize(function(){return e.hideLoading()}),l.catchError(function(e){return e})).subscribe(function(t){t&&e.handleEmployeeInfo(t)})},t.handleEmployeeInfo=function(e){var t=e.corpConfig.corpType,r=t===u.CorpType.GovernmentSK||t===u.CorpType.SK,o=this.corpNameOps[t]||e.corpName;this.setData({employeeInfo:Object.assign({},e,{corpName:o}),isSK:r})},t.getRoleInfo=function(){var e=this;this.showLoading("请求中"),this.employeeRoleHttpService.getEmployeeRoles().pipe(l.finalize(function(){return e.hideLoading()}),l.catchError(function(t){return e.handleErrorService.handle(t)})).subscribe(function(t){if(t.length>1){e.setData({roles:t});var r=t.map(function(t){var r=t.name,o=t.corpName,i=t.corpType,n=t.employeeId;return{name:r+" "+(e.corpNameOps[i]||o),employeeId:n}});e.setData({rolesActions:r,showRoleSheet:!0})}else e.toastService.info("暂无更多身份")})},t.toLogin=function(){this.routerService.toAuthorizeLogin()},t.handleShowInvitations=function(){this.setData({showInvitations:!0})},t.handleShowRoleSheet=function(){this.checkLogin()&&this.getRoleInfo()},t.handleCloseRoleSheet=function(){this.setData({showRoleSheet:!1})},t.handleSelectRole=function(e){var t=this,r=e.currentTarget.dataset.id;r!==this.data.employeeInfo.id&&(this.showLoading("切换中"),this.employeeRoleHttpService.chooseEmployeeRole({employeeId:r}).pipe(l.tap(function(e){t.tokenService.saveToken(e.token)}),l.switchMap(function(){return t.loginService.getEmployeeInfoRequest()}),l.finalize(function(){return t.hideLoading()}),l.catchError(function(e){return t.handleErrorService.handle(e)})).subscribe(function(e){e&&t.handleCloseRoleSheet()}))},t.toOrders=function(e){if(this.checkLogin()){var t=e.currentTarget.dataset.category;wx.navigateTo({url:"/app/pages/order-list/order-list?category="+t})}},t.toSetting=function(){this.checkLogin()&&(this.handleCloseRoleSheet(),wx.navigateTo({url:"/app/package-mine/pages/mine-setting/mine-setting"}))},t.toTravelPolicy=function(){this.checkLogin()&&wx.navigateTo({url:"/app/package-mine/pages/travel-policy/travel-policy"})},t.toEmployeeInfoManagement=function(){this.checkLogin()&&wx.navigateTo({url:"/app/package-mine/pages/general-info-management/general-info-management"})},t.toPointDetail=function(){this.checkLogin()&&wx.navigateTo({url:"/app/package-mine/pages/point-detail/point-detail"})},t.toFeedback=function(){this.checkLogin()&&wx.navigateTo({url:"/app/package-mine/pages/feedback/feedback"})},t.toUserProtocol=function(){wx.navigateTo({url:"/app/package-mine/pages/user-protocol/user-protocol"})},t.checkLogin=function(){return!!this.data.employeeInfo||(this.setData({employeeInfo:null}),this.toastService.info("请先进行登录！"),!1)},t.bindGetPhoneNumber=function(e){console.log(e.detail)},t.handleMakePhoneCall=function(){var e=this;this.showLoading("获取中"),this.commonHttpService.getCommonInfoAllCorpType().pipe(l.map(function(t){var r="400-8840-055";if(e.data.employeeInfo){var o=e.data.employeeInfo.corpConfig.corpType;r=t.numbers.find(function(e){return o===e.corpType}).serviceNumber}return r}),l.finalize(function(){return e.hideLoading()}),l.catchError(function(t){return e.handleErrorService.handle(t)})).subscribe(function(e){wx.makePhoneCall({phoneNumber:e})})},t.onChooseAvatar=function(e){var t=e.detail.avatarUrl;this.setData({avatarUrl:t})},e}();d=o([p.injectable(),c.loading,i("design:paramtypes",[function(){this.statusBarHeight=0,this.menuButtonHeight=0,this.tipIcon=c.OSSPrefix+"/common/tip-icon.svg",this.userSexIcon={Male:c.OSSPrefix+"/common/user-thumbnail-male.svg",Female:c.OSSPrefix+"/common/user-thumbnail-female.svg",default:c.OSSPrefix+"/common/user-thumbnail.svg"},this.OrderStatusIcon={cancelled:c.OSSPrefix+"/order-status/cancelled.svg",processing:c.OSSPrefix+"/order-status/processing.svg",toTravel:c.OSSPrefix+"/order-status/to-travel.svg",unpaid:c.OSSPrefix+"/order-status/unpaid.svg"},this.rolesActions=[],this.isSK=!1,this.tabBarIndex=1,this.invitationCount=0,this.showInvitations=!1},a.TokenService,a.ToastService,a.RouterService,a.HandleErrorService,s.GlobalDataService,n.EmployeeRoleHttpService,a.InvitationsService,n.CommonHttpService,h.ApprovalMixedService,f.LoginService])],d),Page(p.container.resolve(d))},1152:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var n,a=r(14),s=r(8),c=r(6),l=r(5),u=r(0);!function(e){e.Flight="Flight",e.Hotel="Hotel",e.IntFlight="IntFlight",e.IntHotel="IntHotel",e.Train="Train"}(n||(n={}));var p=function(){function e(e,t,r,o,i){this.data=e,this.toastService=t,this.handleErrorService=r,this.userOrderHttpService=o,this.router=i,this.searchParams={pageNumber:1}}var t=e.prototype;return t.onLoad=function(e){this.setQueryCategory(e.category),this.getOrderList(!1)},t.getOrderList=function(e){var t=this;this.showLoading("加载中···"),this.getOrdersRequest().pipe(l.finalize(function(){return t.hideLoading()}),l.catchError(function(e){return t.handleErrorService.handle(e)})).subscribe(function(r){t.setOrderList(e,r)})},t.setOrderList=function(e,t){if(e){var r=this.data.orderList.concat(t);this.setData({orderList:r})}else this.setData({orderList:t})},t.getOrdersRequest=function(){var e=this;return this.userOrderHttpService.getOrders(Object.assign({},this.searchParams)).pipe(l.tap(function(t){return e.totalElements=t.totalElements}),l.map(function(e){return e.content}))},t.onPullDownRefresh=function(){var e=this;this.searchParams.pageNumber=1,this.getOrdersRequest().pipe(l.finalize(function(){wx.stopPullDownRefresh()}),l.catchError(function(t){return e.handleErrorService.handle(t)})).subscribe(function(t){e.setOrderList(!1,t)})},t.onReachBottom=function(){this.data.orderList.length<this.totalElements&&(this.searchParams.pageNumber+=1,this.getOrderList(!0))},t.toFlightOrderDetail=function(e){var t=e.currentTarget.dataset.id;this.router.flight.toOrderDetail(t)},t.toHotelOrderDetail=function(e){var t=e.currentTarget.dataset.id;this.router.hotel.toOrderDetail(t)},t.unsupportedToast=function(){this.toastService.info("暂不支持该类型订单，请到APP查看")},t.handleChangeCategory=function(e){var t=e.currentTarget.dataset.category;this.setQueryCategory(t),this.getOrderList(!1)},t.setQueryCategory=function(e){this.searchParams=e?{pageNumber:1,userOrderQueryCategory:e}:{pageNumber:1},this.setData({selectedCategory:e})},e}();p=o([u.injectable(),c.loading,i("design:paramtypes",[function(){this.orderList=[],this.selectedCategory="",this.bizTypeIconOptions={[n.Flight]:c.OSSPrefix+"/common/order-flight.svg",[n.IntFlight]:c.OSSPrefix+"/common/order-flight.svg",[n.Hotel]:c.OSSPrefix+"/common/order-hotel.svg",[n.IntHotel]:c.OSSPrefix+"/common/order-hotel.svg",[n.Train]:c.OSSPrefix+"/common/order-train.svg"}},s.ToastService,s.HandleErrorService,a.UserOrderHttpService,s.RouterService])],p),Page(u.container.resolve(p))},1153:function(e,t,r){"use strict";function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var a=r(14),s=r(8),c=r(50),l=r(6),u=r(5),p=r(22),h=r(0),f=["今天","明天","后天"],d=l.DateUtils.format(new Date),v=function(){function e(){this.invoiceStatusIcon={[p.InvoiceStatus.Cancelled]:l.OSSPrefix+"/invoice/cancelled.png",[p.InvoiceStatus.Issued]:l.OSSPrefix+"/invoice/issued.png",[p.InvoiceStatus.Reverse]:l.OSSPrefix+"/invoice/reverse.png",[p.InvoiceStatus.Submitted]:l.OSSPrefix+"/invoice/wait-issue.png",[p.InvoiceStatus.WaitIssue]:l.OSSPrefix+"/invoice/wait-issue.png"},this.orderTravelTypeImage={[p.TravelType.OnBusiness]:l.OSSPrefix+"/common/order-business.png",[p.TravelType.OnPrivate]:l.OSSPrefix+"/common/order-private.png"},this.hotelContractImg=r(809),this.returnGuests=[],this.showRoomDetailPopup=!1,this.showGuestList=!0,this.showReturnGuestList=!0}var t,i,n;return t=e,(i=[{key:"checkInDateAlias",get:function(){var e=this.orderDetail;if(!e)return"";var t=e.checkInDate,r=l.DateUtils.differenceInDays(t,d);return f[r]||l.DateUtils.format(t,l.shortWeekFormat)}},{key:"checkOutDateAlias",get:function(){var e=this.orderDetail;if(!e)return"";var t=e.checkOutDate,r=l.DateUtils.differenceInDays(t,d);return f[r]||l.DateUtils.format(t,l.shortWeekFormat)}},{key:"canBookAgain",get:function(){var e=this.orderDetail;if(!e)return!1;var t=e.orderSource,r=e.createTime;return"Manual"!==t&&l.DateUtils.isAfter(r,"2021-12-09")}}])&&o(t.prototype,i),n&&o(t,n),e}(),m=function(){function e(e,t,r,o,i,n,a){this.data=e,this.toastService=t,this.handleErrorService=r,this.hotelOrderQueryHttpService=o,this.hotelOrderHttpService=i,this.globalDataService=n,this.routerService=a}var t=e.prototype;return t.onLoad=function(e){var t=e.backToFirstPage;this.id=e.id,this.getHotelDetail(),this.setData({isSK:this.globalDataService.getGlobalData().isSK,backToFirstPage:!!+t})},t.getHotelDetail=function(){var e=this;this.showLoading(),this.hotelOrderQueryHttpService.getDetail(this.id).pipe(u.finalize(function(){return e.hideLoading()}),u.catchError(function(t){return e.handleErrorService.handle(t)})).subscribe(function(t){var r=t.guests,o=[];r.forEach(function(e){var t=e.dayInfos.filter(function(e){return"Returned"===e.status||"ReturnApply"===e.status}).map(function(e){return e.begin});t.length&&o.push(Object.assign({},e,{returnDayInfos:t}))}),e.setData({orderDetail:t,returnGuests:o})})},t.handleShowRoomDetailPopup=function(){this.setData({showRoomDetailPopup:!0})},t.handleCloseRoomDetailPopup=function(){this.setData({showRoomDetailPopup:!1})},t.handleToggleGuestList=function(){this.setData({showGuestList:!this.data.showGuestList})},t.handleToggleReturnGuestList=function(){this.setData({showReturnGuestList:!this.data.showReturnGuestList})},t.handleShowOrderFee=function(){this.setData({orderDetailProps:this.data.orderDetail})},t.onPullDownRefresh=function(){var e=this;this.showLoading(),this.hotelOrderQueryHttpService.getDetail(this.id).pipe(u.finalize(function(){e.hideLoading(),wx.stopPullDownRefresh()}),u.catchError(function(t){return e.handleErrorService.handle(t)})).subscribe(function(t){e.setData({orderDetail:t})})},t.handleRepeatBooking=function(){var e=this.data.orderDetail,t=e.travelType,r=e.hotel,o=l.DateUtils.format(new Date),i=l.DateUtils.format(l.DateUtils.addDays(new Date,1)),n=r.hotelCode,a={checkInDate:o,checkOutDate:i,cityCode:r.cityCode,travelType:t,hotelId:n};this.routerService.hotel.toHotelDetail(a)},t.handlePayment=function(){var e=this.data.orderDetail,t=e.id,r=e.payMode,o=e.paymentAmount,i={bizType:p.BizType.Hotel,orderId:t,payMode:r,price:o};this.setData({payModalProps:i})},t.handleCanceled=function(){var e=this,t="WaitTicket"===this.data.orderDetail.status?"您的订单正在确认中，可能取消失败是否继续？":"取消订单后，下次预订价格可能发生变动，是否确定取消？";wx.showModal({content:t,cancelText:"放弃",cancelColor:"#007AFF",confirmText:"继续取消",confirmColor:"#007AFF",success:function(t){t.confirm&&e.canceledOrder()}})},t.canceledOrder=function(){var e=this;this.showLoading("取消中"),this.hotelOrderHttpService.cancelOrder(this.id).pipe(u.finalize(function(){return e.hideLoading()}),u.catchError(function(t){return e.handleErrorService.handle(t)})).subscribe(function(){e.toastService.success("取消成功"),e.getHotelDetail()})},t.handleToReturnPage=function(){wx.navigateTo({url:"/app/pages/hotel-return/hotel-return?id="+this.id})},t.throttlePayCancel=function(){this.toastService.info("支付已取消")},t.throttlePaySuccess=function(){var e=this;setTimeout(function(){e.getHotelDetail()},2e3)},t.handleGuestDetail=function(e){var t=e.currentTarget.dataset.id,r=this.data.orderDetail.guests.find(function(e){return e.subOrderId===t}),o={guestName:r.guestName,docType:r.docType,docNo:r.docNo,approvalNo:r.approvalNo,approvalStatus:r.approvalStatus,belongedDeptName:r.belongedDeptName,projectName:r.projectName,birthday:r.birthday,mobile:r.mobile};wx.navigateTo({url:"/app/pages/common/guest-detail/guest-detail?guest="+JSON.stringify(o)})},t.handleToInvoice=function(){var e=this.data.orderDetail.invoice;wx.previewImage({current:e.filePaths[0],urls:e.filePaths})},e}();m=i([h.injectable(),l.loading,n("design:paramtypes",[v,s.ToastService,s.HandleErrorService,a.HotelOrderQueryHttpService,a.HotelOrderHttpService,c.GlobalDataService,s.RouterService])],m),Page(h.container.resolve(m))},1154:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),a=r(0),s=r(8),c=r(5),l=r(6),u=r(22),p=function(){function e(e,t,r,o,i){this.data=e,this.toastService=t,this.handleErrorService=r,this.hotelOrderQueryHttpService=o,this.hotelOrderHttpService=i}var t=e.prototype;return t.onLoad=function(e){this.id=e.id,this.getHotelDetail()},t.getHotelDetail=function(){var e=this;this.showLoading(),this.hotelOrderQueryHttpService.getDetail(this.id).pipe(c.finalize(function(){return e.hideLoading()}),c.catchError(function(t){return e.handleErrorService.handle(t)})).subscribe(function(t){e.setData({orderDetail:t})})},t.handleApplyReturn=function(){var e=this,t={mode:u.ReturnMode.WholeReturn,orderId:this.id};this.showLoading("退订中"),this.hotelOrderHttpService.applyReturn(t).pipe(c.finalize(function(){return e.hideLoading()}),c.catchError(function(t){return e.handleErrorService.handle(t)})).subscribe(function(){e.toastService.success("退订成功");wx.navigateTo({url:"/app/pages/common/order-operate-result/order-operate-result?id="+e.id+"&props="+JSON.stringify({type:"success",title:"退订申请",result:"提交成功",description:"退订申请已提交成功，请留意邮件短信通知"})})})},t.handleToUntwist=function(){wx.navigateTo({url:"/app/pages/hotel-untwist-return/hotel-untwist-return?id="+this.id})},t.handleShowOrderFee=function(){this.setData({orderDetailProps:this.data.orderDetail})},e}();p=o([a.injectable(),l.loading,i("design:paramtypes",[function(){},s.ToastService,s.HandleErrorService,n.HotelOrderQueryHttpService,n.HotelOrderHttpService])],p),Page(a.container.resolve(p))},1155:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),a=r(0),s=r(8),c=r(5),l=r(6),u=r(22),p=function(){function e(e,t,r,o,i){this.data=e,this.toastService=t,this.handleErrorService=r,this.hotelOrderQueryHttpService=o,this.hotelOrderHttpService=i}var t=e.prototype;return t.onLoad=function(e){this.id=e.id,this.getHotelDetail()},t.getHotelDetail=function(){var e=this;this.showLoading(),this.hotelOrderQueryHttpService.getDetail(this.id).pipe(c.finalize(function(){return e.hideLoading()}),c.catchError(function(t){return e.handleErrorService.handle(t)})).subscribe(function(t){var r=t.guests.map(function(e){var t=e.dayInfos,r=e.subOrderId,o=e.guestName,i=e.belongedDeptName,n=t.map(function(e){var t="TicketSuccess"===e.status;return Object.assign({},e,{selected:!1,canReturn:t})}),a=n.some(function(e){return e.canReturn});return{subOrderId:r,guestName:o,belongedDeptName:i,dayInfos:n,guestCanReturn:a}});e.setData({orderDetail:t,guests:r})})},t.handleSelectedRoomDay=function(e){var t=this.data.guests,r=e.currentTarget.dataset,o=r.guestIndex,i=r.dayIndex,n=t[o].dayInfos[i];n.selected=!n.selected,this.setData({guests:t})},t.handleApplyPartReturn=function(){var e=this;this.showLoading("退订中"),this.hotelOrderHttpService.applyReturn(this.getPartReturnParams()).pipe(c.finalize(function(){return e.hideLoading()}),c.catchError(function(t){return e.handleErrorService.handle(t)})).subscribe(function(){e.toastService.success("退订成功");wx.navigateTo({url:"/app/pages/common/order-operate-result/order-operate-result?id="+e.id+"&props="+JSON.stringify({type:"success",title:"退订申请",result:"提交成功",description:"退订申请已提交成功，请留意邮件短信通知"})})})},t.getPartReturnParams=function(){var e=this.data.guests,t=[];return e.forEach(function(e){var r=e.dayInfos,o=e.subOrderId,i=r.filter(function(e){return e.selected}).map(function(e){return e.id});i.length&&t.push({subOrderId:o,dayIds:i})}),{mode:u.ReturnMode.PartReturn,orderId:this.id,returnRooms:t}},e}();p=o([a.injectable(),l.loading,i("design:paramtypes",[function(){},s.ToastService,s.HandleErrorService,n.HotelOrderQueryHttpService,n.HotelOrderHttpService])],p),Page(a.container.resolve(p))},1156:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var n=r(79),a=r(8),s=r(6),c=r(16),l=r(5),u=r(22),p=r(0),h=r(124),f=r(319),d=r(125),v=r(317),m=r(810),g=r(811),y=function(e){var t,r;function o(t,r,o,i,n,a,s){var l;return(l=e.call(this,i)||this).data=t,l.frontHotelSearchHttpService=r,l.conditionService=o,l.locationService=n,l.globalDataService=a,l.routerService=s,l.sliderValue$=new c.Subject,l.httpRequest=l.frontHotelSearchHttpService.searchHotels.bind(l.frontHotelSearchHttpService),l}r=e,(t=o).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i=o.prototype;return i.onShow=function(){var e=this,t=wx.createSelectorQuery();t.select("#content").boundingClientRect(function(t){e.setData({contentHeight:t.height})}),t.exec()},i.onLoad=function(e){var t=this;this.hotelSearchProps=JSON.parse(e.params);var r=this.globalDataService.isSK?u.TravelType.OnPrivate:this.hotelSearchProps.travelType;this.setData({travelType:r,hasContractHotel:this.globalDataService.hasContractHotel}),this.form=v.createForm();var o=this.form;o.patchValue(Object.assign({},this.hotelSearchProps,{orderBy:g.OrderBy.Default,searchProtocolType:"All",condition:Object.assign({hotelLevels:[]},this.hotelSearchProps.condition),travelType:r})),o.valueChanges.pipe(l.startWith(o.value)).subscribe(function(e){t.setData({formData:e})}),this.query(),this.initCityBaseInfo(this.hotelSearchProps.cityCode),this.sliderValue$.pipe(l.debounceTime(50)).subscribe(function(e){var r=e[0],o=e[1];t.setData({_minPrice:r,_maxPrice:o})}),wx.getSystemInfo().then(function(e){t.setData({screenHeight:e.screenHeight})}),this.conditionService.getBrands().pipe(l.catchError(function(e){return t.handleErrorService.handle(e)})).subscribe(function(e){var r=e.map(function(e){return{selected:!1,name:e}});t.setData({brands:r})})},i.processResult=function(e){var t=this.getHotels(e.hotels);return Object.assign({},e,{hotels:t})},i.getQueryParams=function(){var e=Object.assign({},this.form.value),t=Object.assign({},e).condition;return"Poi"!==t.tipWordType&&(t.coordinates=null),s.removeEmpty(e)},i.throttlescrolltolower=function(){this.loadMore()},i.throttleChooseHotel=function(e){var t=e.currentTarget.dataset.hotelid,r=this.data,o=r.formData,i=r.travelType,n={checkInDate:o.checkInDate,checkOutDate:o.checkOutDate,cityCode:o.cityCode,travelType:i,hotelId:t};this.routerService.hotel.toHotelDetail(n)},i.throttleOpenLocation=function(e){var t=e.currentTarget.dataset.item,r=t.coordinates,o=r.lat,i=r.lon,n=t.address,a=t.hotelName;this.locationService.BaiDuToGCJ(+o,+i).subscribe(function(e){var t=e.lat,r=e.lng;wx.openLocation({longitude:r,latitude:t,name:a,address:n})})},i.getHotels=function(e){return e.map(function(e){return Object.assign({},e,{scoreInfo:d.getHotelScoreInfo(e),stars:d.getHotelStars(e)})})},i.throttleChooseDate=function(){this.setData({calenderVisible:!0})},i.throttleDateClose=function(){this.setData({calenderVisible:!1})},i.throttleDateConfirm=function(e){var t=e.detail,r=t[0],o=t[1];r=s.DateUtils.format(r),o=s.DateUtils.format(o),this.form.patchValue({checkInDate:r,checkOutDate:o}),this.setData({calenderVisible:!1}),this.query()},i.throttleChooseCondition=function(){var e=this,t=this.data,r=t.formData,o=t.travelType,i={checkInDate:r.checkInDate,checkOutDate:r.checkOutDate,cityCode:r.cityCode,travelType:o};this.conditionService.getCondition(i).subscribe(function(t){var o=s.removeEmpty(t).conditions,i=o.condition;o.keyWord&&"Poi"===r.condition.tipWordType&&(i.tipWordType=null,i.position=null),"Poi"===i.tipWordType&&(o.keyWord=""),e.form.patchValue(Object.assign({},o)),e.query()})},i.throttleClearKeyword=function(){this.form.patchValue({keyWord:""}),"Poi"===this.data.formData.condition.tipWordType&&this.form.patchValue({condition:{position:null,tipWordType:null}}),this.query()},i.throttleOrderChange=function(e){var t=e.detail;this.form.patchValue({orderBy:t}),this.query()},i.handlePriceDrag=function(e){this.sliderValue$.next(e.detail.value)},i.throttlePriceConfirm=function(){var e=this.data,t=e._minPrice,r=e._maxPrice,o=e.levelsInPopup,i=d.getSliderValue(t,r);this.form.patchValue({condition:{priceRanges:i,hotelLevels:[].concat(o)}}),this.selectComponent("#dropdown_price").toggle(),this.query()},i.throttlePriceClear=function(){this.form.patchValue({condition:{priceRanges:[{priceFrom:null,priceTo:null}],hotelLevels:[]}}),this.selectComponent("#dropdown_price").toggle(),this.query()},i.handleChoosePriceItem=function(e){var t=e.currentTarget.dataset.price,r=t.min,o=t.max;this.setData({_minPrice:r||0,_maxPrice:o})},i.handleChooseLevelItem=function(e){var t=e.currentTarget.dataset.level,r=this.data.levelsInPopup,o=r.indexOf(t);-1===o?r.push(t):r.splice(o,1),this.setData({levelsInPopup:r})},i.throttleOpenPrice=function(){var e=this.data.formData.condition,t=e.priceRanges,r=e.hotelLevels,o=t[0],i=o.priceFrom,n=o.priceTo;this.setData({_minPrice:i||d.sliderMin,_maxPrice:n||d.sliderMax,levelsInPopup:[].concat(r)})},i.throttleCommonFilter=function(e){var t=e.currentTarget.dataset,r=t.index,o=t.pindex,i=this.data.filterList,n=i[o].data;n.forEach(function(e,t){t!==r&&(e.selected=!1)});var a=n[r];a.selected=!a.selected,this.setData({filterList:i})},i.handleBrandSelect=function(e){var t=e.currentTarget.dataset.index,r=this.data.brands,o=r[t];o.selected=!o.selected,this.setData({brands:r})},i.throttleBrandConfirm=function(){var e=this.data.brands.filter(function(e){return e.selected}).map(function(e){return e.name});this.form.patchValue({condition:{brands:e}}),this.selectComponent("#dropdown_brand").toggle(),this.query()},i.throttleBrandClear=function(){this.form.patchValue({condition:{brands:null}}),this.selectComponent("#dropdown_brand").toggle(),this.query()},i.throttleOpenBrand=function(){var e=this.data,t=e.brands,r=e.formData.condition.brands,o=t.map(function(e){return Object.assign({},e,{selected:r&&r.includes(e.name)})});this.setData({brands:o})},i.initCityBaseInfo=function(e){var t=this;this.conditionService.getCityBaseInfo(e).subscribe(function(e){var r=e.counties,o=e.businessZones,i=e.metros,n=e.hotPorts,a=f.getBaseInfoCats().map(function(e){var t,a=e.type;switch(a){case"MetroStation":i&&(t=i.map(function(e,t){return Object.assign({},e,{activated:0===t})}));break;case"District":t=r;break;case"BusinessZone":o.length&&(t=o.map(function(e){return{code:e.nameCn,name:e.nameCn}}));break;default:var s=n.find(function(e){return e.typeName===a});s&&(t=s.hotPorts)}return Object.assign({},e,{children:t})}).filter(function(e){return e.children&&e.children.length}).map(function(e,t){return Object.assign({},e,{activated:0===t})});t.setData({cityBaseInfo:e,cityBaseInfoCats:a})})},i.handleChangeArea=function(e){var t=e.currentTarget.dataset.index,r=this.data.cityBaseInfoCats;r.forEach(function(e){e.activated=!1,e.children.forEach(function(e){e.activated=!1})}),r[t].activated=!0,this.setData({cityBaseInfoCats:r})},i.handleChangeAreaChild=function(e){var t=e.currentTarget.dataset.index,r=this.data.catActivatedChildren,o=r[t];o.activated=!o.activated,r.forEach(function(e,r){r!==t&&(e.activated=!1)}),this.setData({catActivatedChildren:r})},i.throttleChangeMetroStation=function(e){var t=e.currentTarget.dataset.index,r=this.data.metroStations;r.forEach(function(e){return e.activated=!1}),r[t].activated=!0,this.setData({metroStations:r})},i.throttleAreaConfirm=function(){var e=this.data.cityBaseInfoCats.find(function(e){return e.activated}),t=e.type,r=e.children.find(function(e){return e.activated}),o={tipWordType:null,position:null};if(r)switch(t){case"District":o.tipWordType=t,o.position=r.name;break;case"MetroStation":var i=r.stations.find(function(e){return e.activated});i&&(o.tipWordType=t,o.position=i.name);break;case"BusinessZone":default:o.tipWordType=t,o.position=r.name}this.form.patchValue({condition:o}),this.selectComponent("#dropdown_area").toggle(),this.query()},i.throttleAreaClear=function(){this.form.patchValue({condition:{tipWordType:null,position:null}}),this.selectComponent("#dropdown_area").toggle(),this.query()},i.throttleCloseDropdown=function(){this.selectComponent("#dropdown_price").toggle(!1),this.selectComponent("#dropdown_brand").toggle(!1),this.selectComponent("#dropdown_area").toggle(!1)},i.handleOnlyAgreement=function(){var e="All"===this.data.formData.searchProtocolType?"ProtocolPriceOnly":"All";this.form.patchValue({searchProtocolType:e}),this.query()},i.throttleOpenArea=function(){var e=this.data,t=e.cityBaseInfoCats,r=e.formData.condition,o=r.position,i=r.tipWordType,n=t.map(function(e){return Object.assign({},e,{children:e.children.map(function(e){return Object.assign({},e)}),selected:!1,activated:!1})});n.forEach(function(e){e.children.forEach(function(e){e.activated=!1,e.selected=!1;var t=e.stations;t&&t.forEach(function(e){e.activated=!1,e.selected=!1})})});var a=n.find(function(e){return e.type===i});if(a)if("MetroStation"===a.type){var s,c;a.children.forEach(function(e){var t=e.stations.find(function(e){return e.name===o});t&&(s=e,c=t)}),s&&(s.activated=!0,s.selected=!0,a.activated=!0,a.selected=!0,c.activated=!0,c.selected=!0)}else{var l=a.children.find(function(e){return e.name===o});l.activated=!0,l.selected=!0,a.activated=!0,a.selected=!0}a||(n[0].activated=!0),this.setData({cityBaseInfoCats:n})},i.handleScroll=function(e){var t=this.data.screenHeight;if(t){var r=e.detail.scrollTop;this.setData({goTopBtnVisible:r>t})}},i.throttleGoTop=function(){this.setData({scrollTop:0})},i.throttleToLevelExplain=function(){wx.navigateTo({url:"./level-explain/level-explain"})},i.onShareAppMessage=function(){return{title:"我分享了"+(this.hotelSearchProps.cityName||"特航")+"的酒店给你",path:"/app/pages/hotel/display/display?params="+JSON.stringify(Object.assign({},this.hotelSearchProps,this.getQueryParams()))}},o}(m.PaginationPage);y=o([p.injectable(),s.loading,i("design:paramtypes",[g.HotelDisplayData,n.FrontHotelSearchHttpService,h.ConditionService,a.HandleErrorService,a.LocationService,a.GlobalDataService,a.RouterService])],y);var b=p.container.resolve(y);Page(b)},1157:function(e,t,r){"use strict";Page({})},1158:function(e,t,r){"use strict";function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},a=this&&this.__rest||function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(r[o[i]]=e[o[i]])}return r};Object.defineProperty(t,"__esModule",{value:!0});var s=r(79),c=r(8),l=r(6),u=r(5),p=r(22),h=r(0),f=r(125),d=r(320),v=r(321),m=["今天","明天","后天"],g=l.DateUtils.format(new Date),y=function(){function e(){this.calenderVisible=!1,this.formatter=function(e){return"start"===e.type?e.bottomInfo="入住":"end"===e.type&&(e.bottomInfo="离店"),e},this.maxdate=l.DateUtils.addYears(new Date,1).valueOf(),this.roomList=[],this.phoneCallActionVisible=!1,this.OSSPrefix=l.OSSPrefix,this.roomDetailPopupVisible=!1}var t,r,i;return t=e,(r=[{key:"calendarDefaultDate",get:function(){var e=this.params;if(!e)return null;var t=e.checkInDate,r=e.checkOutDate;return[new Date(l.DateUtils.format(t)).valueOf(),new Date(l.DateUtils.format(r)).valueOf()]}},{key:"telList",get:function(){var e=this.detail;if(!e)return[];var t=e.phoneNum;return t?t.split("/"):[]}},{key:"phoneCallActions",get:function(){var e=this.telList;return e?e.map(function(e){return{name:e}}):[]}},{key:"checkInDateAlias",get:function(){var e=this.params;if(!e)return"";var t=e.checkInDate,r=l.DateUtils.differenceInDays(t,g);return m[r]||l.DateUtils.format(t,l.shortWeekFormat)}},{key:"checkOutDateAlias",get:function(){var e=this.params;if(!e)return"";var t=e.checkOutDate,r=l.DateUtils.differenceInDays(t,g);return m[r]||l.DateUtils.format(t,l.shortWeekFormat)}},{key:"totalDays",get:function(){var e=this.params;if(e){var t=e.checkInDate,r=e.checkOutDate;if(t)return l.DateUtils.differenceInDays(r,t)}return""}},{key:"defaultHotelImageUrl",get:function(){return this.OSSPrefix+"/hotel/hotel.svg"}},{key:"defaultHotelRoomImageUrl",get:function(){return this.OSSPrefix+"/hotel/hotel-room.svg"}},{key:"supplierTabVisible",get:function(){var e=this.supplierGroups;return!!e&&e.length>1}},{key:"isEmpty",get:function(){var e=this.supplierGroups;return!!e&&0===e.length}}])&&o(t.prototype,r),i&&o(t,i),e}(),b=function(){function e(e,t,r,o,i,n,a,s){this.data=e,this.hotelSearchHttpService=t,this.loadingService=r,this.handleErrorService=o,this.picturesService=i,this.hotelPlaceOrderService=n,this.locationService=a,this.globalDataService=s}var t=e.prototype;return t.onLoad=function(e){var t=JSON.parse(e.hotelDetailProps),r=t.travelType,o=a(t,["travelType"]),i=Object.assign({},o),n=this.globalDataService.isSK;this.setData({params:i,travelType:n?p.TravelType.OnPrivate:r}),this.requestHotelDetail(i)},t.requestHotelDetail=function(e){var t=this,r=!!this.data.detail;r&&this.loadingService.showLoading(),this.hotelSearchHttpService.searchHotelDetail(e).pipe(u.catchError(function(e){return t.handleErrorService.handle(e)})).subscribe(function(o){r&&t.loadingService.hideLoading();var i=f.getHotelScoreInfo(o),n=f.getHotelStars(o),a=o.rooms,s=f.getRoomList(a),c=s.roomList,l=s.sendOutRoomList,u=f.getRoomsGroupedBySupplier(c,l),p=f.getRecommendRooms(c),h=o.pictures?o.pictures.slice(0,6).map(function(e){return e.url}):[t.data.defaultHotelImageUrl];t.setData({detail:o,params:e,scoreInfo:i,stars:n,recommendGroup:p,supplierGroups:u,imgList:h,currentSupplier:1===u.length?u[0].supplier:null})})},t.throttleChooseDate=function(){this.setData({calenderVisible:!0})},t.throttleDateClose=function(){this.setData({calenderVisible:!1})},t.throttleDateConfirm=function(e){var t=e.detail,r=t[0],o=t[1];r=l.DateUtils.format(r),o=l.DateUtils.format(o),this.setData({calenderVisible:!1});var i=Object.assign({},this.data.params,{checkInDate:r,checkOutDate:o});this.requestHotelDetail(i)},t.throttleScrollToDetail=function(){wx.pageScrollTo({selector:"#detail_begin"})},t.throttleOpenLocation=function(){var e=this.data.detail,t=e.coordinates,r=t.lat,o=t.lon,i=e.address,n=e.hotelName;this.locationService.BaiDuToGCJ(r,o).subscribe(function(e){var t=e.lat,r=e.lng;wx.openLocation({longitude:r,latitude:t,name:n,address:i})})},t.throttleShowPhoneCall=function(){this.setData({phoneCallActionVisible:!0})},t.throttlePhoneCallActionClose=function(){this.setData({phoneCallActionVisible:!1})},t.throttlePhoneCallActionSelect=function(e){wx.makePhoneCall({phoneNumber:e.detail.name})},t.throttleToPictures=function(){var e=this.data.detail,t=e.pictures,r=e.hotelName;this.picturesService.toPicturePage(r,t)},t.throttleBook=function(e){var t=e.detail,r=t.plancode,o=t.roomcode,i=this.data,n=i.params,a=i.detail,s=i.travelType;this.hotelPlaceOrderService.toPlaceOrderPage(n,a,o,r,s)},t.throttleOpenRoomDetailPopup=function(e){var t=e.detail,r=t.room,o=t.rateplan;this.setData({room:r,ratePlan:o,roomDetailPopupVisible:!0})},t.throttleChangeCurrentSupplier=function(e){var t=e.currentTarget.dataset.supplier;this.setData({currentSupplier:t||""})},t.throttleCloseRoomDetailPopup=function(){this.setData({roomDetailPopupVisible:!1})},t.onShareAppMessage=function(){var e=this.data,t=e.params,r=e.travelType,o=e.detail,i=Object.assign({},t,{travelType:r});return{title:""+o.hotelName,path:"/app/pages/hotel/detail/detail?hotelDetailProps="+JSON.stringify(i),imageUrl:""+o.mainPictureUrl}},e}();b=i([h.injectable(),n("design:paramtypes",[y,s.FrontHotelSearchHttpService,c.LoadingService,c.HandleErrorService,v.PicturesService,d.HotelPlaceOrderService,c.LocationService,c.GlobalDataService])],b);var S=h.container.resolve(b);Page(S)},1159:function(e,t,r){"use strict";function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=r(321),c=function(){function e(){this.list=[]}var t,r,i;return t=e,(r=[{key:"total",get:function(){return this.list.reduce(function(e,t){return e+t.photoList.length},0)}}])&&o(t.prototype,r),i&&o(t,i),e}(),l=function(){function e(e,t){this.data=e,this.picturesService=t}var t=e.prototype;return t.onLoad=function(){var e=this.picturesService.getHotelPhotoByType().list;this.setData({list:e})},t.throttleScrollToTop=function(){wx.pageScrollTo({scrollTop:0})},t.throttleScrollTo=function(e){var t=e.currentTarget.dataset.id,r=wx.createSelectorQuery();r.select(".nav").boundingClientRect(),r.exec(function(e){var r=e[0].height,o=wx.createSelectorQuery();o.select(t).boundingClientRect(),o.selectViewport().scrollOffset(),o.exec(function(e){var t=e[0].top,o=e[1].scrollTop;wx.pageScrollTo({scrollTop:t+o-r})})})},t.throttleImageTap=function(e){var t=e.currentTarget.dataset,r=t.url,o=t.list;wx.previewImage({urls:o.map(function(e){return e.url}),current:r})},e}();l=i([a.injectable(),n("design:paramtypes",[c,s.PicturesService])],l),Page(a.container.resolve(l))},1160:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),a=r(79),s=r(8),c=r(50),l=r(6),u=r(32),p=r(16),h=r(5),f=r(22),d=r(0),v=r(124),m=r(322),g=r(812),y=r(813),b=r(320),S=r(323),D=function(){function e(e,t,r,o,i,n,a,s,c,l,u,h,f,d,v,m,g,y){this.data=e,this.hotelPlaceOrderService=t,this.hotelOrderHttpService=r,this.frontHotelSearchHttpService=o,this.handleErrorService=i,this.employeeSelectService=n,this.corpHotelPolicyService=a,this.employeeManageHttpService=s,this.validateService=c,this.travellerEditService=l,this.toastService=u,this.hotelOrderFeeHttpService=h,this.hotelOrderQueryHttpService=f,this.routerService=d,this.invoiceSelectService=v,this.frequentTravellerSelectService=m,this.frequentTravellerModifyService=g,this.globalDataService=y,this.unsubscribe$=new p.Subject}var t=e.prototype;return t.onLoad=function(){var e,t=this.hotelPlaceOrderService.getParams(),r=t.requestParams,o=t.hotel,i=t.planCode,n=t.roomCode,a=t.travelType;o.rooms.forEach(function(t){var r=t.ratePlans.find(function(e){return e.roomCode===n&&e.ratePlanCode===i});r&&(e=Object.assign({},t,{ratePlans:[Object.assign({},r)]}))});var s=this.globalDataService.travelTypeChangeable;this.setData({hotel:o,room:e,roomRequestParams:r,travelType:a,travelTypeChangeable:s}),a===f.TravelType.OnBusiness?this.initBizForm():this.initPersonalForm()},t.initBizForm=function(){var e=this;this.showLoading(),p.combineLatest([this.hotelOrderFeeHttpService.getBookingServiceFee(),this.hotelOrderFeeHttpService.getBookingTrusteeFee(),this.corpHotelPolicyService.getPolicyImplementMixed()]).pipe(h.catchError(function(t){return e.handleErrorService.handle(t)}),h.finalize(function(){e.hideLoading()})).subscribe(function(t){var r=t[0],o=t[1],i=t[2];e.setData({policyConfig:i,trusteeFeeDetail:o,serviceFee:Number(r)});var n=e.globalDataService.getUserInfo(),a={contact:{name:f.getName(n),mobile:n.mobile,email:n.email}},s=m.createHotelPlaceOrderRequestForm(a,i);s.valueChanges.pipe(h.startWith(s.value)).subscribe(function(t){var r=e.data.formData;l.ObjectUtils.deepCompare(r,t)||e.setData({formData:t})}),s.statusChanges.pipe(h.startWith(s.status)).subscribe(function(t){var r=e.validateService.getErrorMsgs(s),o=e.data.errMsgs;l.ObjectUtils.deepCompare(o,r)||e.setData({errMsgs:r})}),e.bizForm=s,e.form=s;var c=s.controls.travelers;if(i.canBookingForOthers){e.roomCountChange=e.roomCountChangeCanBookingForOthers;var u=m.createHotelBizTravelerForm(i);c.push(u)}else e.roomCountChange=e.roomCountChangeOnlyBookingForSelf,e.getEmployeesTravelInfo([n.id]).subscribe(function(t){t.forEach(function(e){c.push(e)}),e.checkOverrun()})})},t.initPersonalForm=function(){var e=this;this.setData({policyConfig:null,serviceFee:0,trusteeFeeDetail:null});var t=this.globalDataService.getUserInfo(),r={contact:{name:f.getName(t),mobile:t.mobile,email:t.email}},o=g.createHotelPlaceOrderPersonalRequestForm(r);o.valueChanges.pipe(h.startWith(o.value)).subscribe(function(t){var r=e.data.personalFormData;l.ObjectUtils.deepCompare(r,t)||e.setData({personalFormData:t})}),o.statusChanges.pipe(h.startWith(o.status)).subscribe(function(t){var r=e.validateService.getErrorMsgs(o),i=e.data.personalErrMsgs;l.ObjectUtils.deepCompare(i,r)||e.setData({personalErrMsgs:r})}),this.personalForm=o,this.form=o;var i=o.controls.travelers;this.roomCountChange=this.roomCountChangePersonal,i.push(g.createHotelPersonalTravelerForm())},t.onUnload=function(){this.unsubscribe$.next()},t.throttleOpenRoomDetailPopup=function(){this.setData({roomDetailPopupVisible:!0})},t.throttleCloseRoomDetailPopup=function(){this.setData({roomDetailPopupVisible:!1})},t.throttleChangeTravelType=function(e){var t=e.currentTarget.dataset.type;t!==this.data.travelType&&(t===f.TravelType.OnBusiness?this.setData({bizTypeDialog:!0}):this.setData({personalTypeDialog:!0}))},t.throttleConfirmBizType=function(){this.setData({travelType:f.TravelType.OnBusiness,bizTypeDialog:!1}),this.initBizForm()},t.throttleConfirmPersonalType=function(){this.setData({travelType:f.TravelType.OnPrivate,personalTypeDialog:!1}),this.initPersonalForm()},t.handleToggleRoomCountOptions=function(){var e=this.data.roomCountOptionsVisible;this.setData({roomCountOptionsVisible:!e})},t.throttleChangeRoomCount=function(e){var t=this,r=this.data.roomCount,o=e.currentTarget.dataset.count;this.checkRoomCount(o).subscribe(function(e){var i=o-r;t.roomCountChange(i),t.setData({roomCountOptionsVisible:!1})})},t.roomCountChange=function(e){},t.roomCountChangeCanBookingForOthers=function(e){var t=this.form.controls.travelers;if(e>0)for(var r=this.data.policyConfig;e-- >0;)t.push(m.createHotelBizTravelerForm(r));else{for(;e++<0;)t.removeAt(t.length-1);this.checkOverrun()}},t.roomCountChangeOnlyBookingForSelf=function(e){var t=this.form.controls.travelers;if(e>0){for(var r=[],o=this.globalDataService.getUserInfo();e-- >0;)r.push(o.id);this.getEmployeesTravelInfo(r).subscribe(function(e){e.forEach(function(e){t.push(e)})})}else for(;e++<0;)t.removeAt(t.length-1)},t.roomCountChangePersonal=function(e){var t=this.form.controls.travelers;if(e>0)for(;e-- >0;)t.push(g.createHotelPersonalTravelerForm());else for(;e++<0;)t.removeAt(t.length-1)},t.checkRoomCount=function(e){var t=this,r=this.data,o=r.roomRequestParams,i=r.hotel,n=r.room,a=r.ratePlan,c=o.checkInDate,l=o.checkOutDate,u=n.supplier,p=n.roomCode,f=a.ratePlanCode,d=a.supplier,v={roomsCount:e,roomSupplier:u,checkInDate:c,checkOutDate:l,hotelDetailId:i.hotelDetailId,roomCode:p,ratePlanCode:f,ratePlanSupplier:d};return this.showLoading("查询中"),this.frontHotelSearchHttpService.hotelPricing(v).pipe(h.finalize(function(){t.hideLoading()}),h.map(function(e){if("PriceMatched"!==e.resultType)throw new s.BizError("酒店价格已过期");return e.pricingResultId}),h.catchError(function(e){return t.handleErrorService.handle(e)}))},t.throttleSelectTraveller=function(){var e=this,t=this.data,r=t.roomCount,o=t.formData.travelers;this.employeeSelectService.select(r,o.filter(function(e){return!!e.referenceId}).map(function(e){return e.employee})).subscribe(function(t){var r=t.map(function(e){return e.id});e.getEmployeesTravelInfo(r).subscribe(function(t){var r=e.form.controls.travelers;l.FormUtils.clearFormArray(r),t.forEach(function(e){r.push(e)}),e.checkOverrun()})})},t.throttleSelectFrequentTraveller=function(){var e=this,t=this.data,r=t.roomCount,o=t.personalFormData.travelers;this.frequentTravellerSelectService.select(r,o.filter(function(e){return!!e.referenceId}).map(function(e){return e.employee})).subscribe(function(t){var r=e.form.controls.travelers;l.FormUtils.clearFormArray(r),t.forEach(function(e){var t=e.id,o=e.mobile,i=e.email,n=g.createHotelPersonalTravelerForm();n.patchValue({employee:e,referenceId:t,mobile:o,email:i}),r.push(n)})})},t.getEmployeesTravelInfo=function(e){var t=this,r=this.data.policyConfig;return this.showLoading("获取入住人详情"),p.combineLatest(e.map(function(e){return t.employeeManageHttpService.getEmployeeForTravelInfo(e)})).pipe(h.finalize(function(){t.hideLoading()}),h.catchError(function(e){return t.handleErrorService.handle(e)}),h.map(function(e){return e.map(function(e){var t=e.id,o=e.mobile,i=e.email,n=e.departmentId,a=e.departmentName,s=e.inApprovalWhiteList,c=r.approvalRequired&&!s,u=m.createHotelBizTravelerForm(Object.assign({},r,{approvalRequired:c}));return u.patchValue({employee:e,referenceId:t,department:{id:n,name:a},mobile:o,email:i}),l.FormUtils.validate(u),u})}))},t.throttleClearTraveler=function(e){var t=e.currentTarget.dataset.index;this.form.controls.travelers.at(t).reset()},t.throttleEditTraveller=function(e){var t=this,r=e.currentTarget.dataset.index,o=this.data,i=o.formData,n=o.policyConfig,a=o.roomRequestParams,s=i.travelers;this.travellerEditService.edit(Object.assign({},s[r]),n,a.checkInDate).subscribe(function(e){t.form.controls.travelers.at(r).patchValue(e)})},t.throttleEditFrequentTraveller=function(e){var t=this,r=e.currentTarget.dataset.index,o=this.data.personalFormData.travelers;this.frequentTravellerModifyService.toModify(o[r].employee.id).subscribe(function(e){var o=t.form.controls.travelers,i=e.id;o.at(r).patchValue({employee:e,referenceId:i})})},t.checkOverrun=function(){var e=this,t=this.data.formData.travelers,r=this.data,o=r.totalDays,i=r.hotel,n=r.singleRoomFee,a=t.filter(function(e){return!!e.referenceId}).map(function(t){var r={travelType:"OnBusiness",guest:{employeeId:t.referenceId,projectId:t.project?t.project.id:null},days:+o,cityCode:i.cityCode,totalRoomFee:n};return e.corpHotelPolicyService.overrunAsyncValidator(r)});p.combineLatest(a).pipe(h.catchError(function(t){return e.handleErrorService.handle(t)})).subscribe(function(r){var o=r.map(function(r,o){return{overrun:r,employee:t[o].employee,overrunPolicyText:e.getOverrunRemindText(r.overrunPolicyOption),referenceId:t[o].referenceId}}).filter(function(e){return e.overrun.overrun});e.setData({overruns:o.length?o:null})})},t.getOverrunRemindText=function(e){switch(e){case"WarningOnly":return"超标无需授权";case"Forbidden":return"超标禁止下单";case"WarningAndAuthorize":case"AuthorizeCompulsively":return"需要授权"}},t.throttleChooseOverrunReason=function(){var e=this.data,t=e.overPriceReasonText,r=e.policyConfig.hotelOverrunReason.optionItems;t&&(-1!==r.indexOf(t)?this.setData({overrunOtherReasonContent:"",overrunReasonOption:t,overrunReasonIsOther:!1}):this.setData({overrunReasonOption:"",overrunOtherReasonContent:t,overrunReasonIsOther:!0})),this.setData({overrunReasonPopup:!0})},t.throttleOverrunOption=function(e){var t=e.currentTarget.dataset.value;this.setData({overrunReasonIsOther:!1,overrunReasonOption:t})},t.throttleOverrunOther=function(){this.setData({overrunReasonIsOther:!0,overrunReasonOption:""})},t.handleOverrunOtherReasonContentInput=function(e){var t=e.detail.value;this.setData({overrunOtherReasonContent:t})},t.throttleConfirmOverrunReason=function(){var e,t=this.data,r=t.overrunReasonOption,o=t.overrunReasonIsOther,i=t.overrunOtherReasonContent;r&&(e=r),o&&i&&(e=i),e?this.setData({overPriceReasonText:e,overrunReasonPopup:!1}):this.toastService.error("请选择或输入超标原因")},t.throttleCloseOverrunReason=function(){this.setData({overrunReasonPopup:!1})},t.throttleLatestArrivalTime=function(e){var t=e.currentTarget.dataset.value;this.form.patchValue({latestArrivalTime:t}),this.setData({latestTimesPopup:!1})},t.throttleOpenLatestTimes=function(){this.setData({latestTimesPopup:!0})},t.throttleCloseLatestTimes=function(){this.setData({latestTimesPopup:!1})},t.handleInput=function(e){var t=e.currentTarget.dataset.name,r=e.detail.value,o=this.form.get(t);o.markAsDirty(),o.setValue(r)},t.throttleSelectInvoice=function(){var e,t=this,r=this.form.value.invoice;if(r){var o=r.email,i=r.memo,n=r.registrationNo;e={email:o,memo:i,invoice:{title:r.title,registrationNo:n,type:r.titleType}}}this.invoiceSelectService.select(e).subscribe(function(e){var r=e.email,o=e.invoice,i=e.memo,n=o.title,a=o.type,s=o.registrationNo;t.form.patchValue({invoice:{email:r,memo:i,registrationNo:s,title:n,titleType:a}})})},t.throttleSubmit=function(){var e=this.bizForm;if(!l.FormUtils.validate(e))return e.updateValueAndValidity(),void this.toastService.error("下单信息未填写完整");var t=this.data,r=t.overruns,o=t.overPriceReasonText,i=t.travelType,n=Object.assign({},m.getFormValue(e),{travelType:i});if(r){if(!o)return void this.toastService.error("请选择超标原因");n.travelers.forEach(function(e){r.find(function(t){return t.referenceId===e.referenceId})&&(e.overPriceReasonText=o)})}this.placeOrder(n)},t.throttleSubmitPersonalOrder=function(){var e=this.personalForm;if(!l.FormUtils.validate(e))return e.updateValueAndValidity(),void this.toastService.error("下单信息未填写完整");var t=this.data.travelType,r=Object.assign({},g.getPersonalFormValue(e),{travelType:t});this.placeOrder(r)},t.placeOrder=function(e){var t=this;this.showLoading("正在下单"),this.checkRoomCount(this.data.roomCount).pipe(h.switchMap(function(r){return t.hotelOrderHttpService.placeOrder(Object.assign({},e,{pricingResultId:r}))})).pipe(h.catchError(function(e){return t.handleErrorService.handle(e)}),h.finalize(function(){t.hideLoading()})).subscribe(function(e){t.showLoading("获取支付信息"),t.hotelOrderQueryHttpService.getDetail(e).pipe(h.catchError(function(e){return t.handleErrorService.handle(e)}),h.finalize(function(){t.hideLoading()})).subscribe(function(r){var o=r.paymentAmount,i=r.payMode,n={bizType:f.BizType.Hotel,orderId:e,payMode:i,price:o};t.setData({payModalProps:n})})})},t.throttlePayCancel=function(){var e=this.data.payModalProps.orderId;this.routerService.hotel.toOrderDetail(e,!0)},t.throttlePaySuccess=function(){var e=this.data.payModalProps.orderId;wx.navigateTo({url:"/app/pages/hotel/pay-result/pay-result?result=success&orderId="+e})},t.handleFeeDetail=function(){var e=this.data.feeDetailPopVisible;this.setData({feeDetailPopVisible:!e})},e}();D=o([d.injectable(),l.loading,i("design:paramtypes",[y.HotelPlaceOrderData,b.HotelPlaceOrderService,n.HotelOrderHttpService,a.FrontHotelSearchHttpService,s.HandleErrorService,v.EmployeeSelectService,s.CorpHotelPolicyService,n.EmployeeManageHttpService,u.ValidateService,S.TravellerEditService,s.ToastService,n.HotelOrderFeeHttpService,n.HotelOrderQueryHttpService,s.RouterService,v.InvoiceSelectService,v.FrequentTravellerSelectService,v.FrequentTravellerModifyService,c.GlobalDataService])],D),Page(d.container.resolve(D))},1161:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),a=r(32),s=r(5),c=r(124),l=r(0),u=r(322),p=r(323),h=function(){function e(e,t,r,o,i,n){this.data=e,this.travellerEditService=t,this.departmentSelectService=r,this.projectSelectService=o,this.validateService=i,this.approvalSelectService=n}var t=e.prototype;return t.onLoad=function(){var e=this,t=this.travellerEditService.getInfo(),r=t.traveller,o=t.policyConfig,i=t.startDate,a=r.employee.inApprovalWhiteList;this.setData({policyConfig:o,startDate:i});var c=o.approvalRequired&&!a,l=u.createHotelBizTravelerForm(Object.assign({},o,{approvalRequired:c}));l.patchValue(r),this.form=l,l.valueChanges.pipe(s.startWith(l.value)).subscribe(function(t){var r=e.data.formData;n.ObjectUtils.deepCompare(r,t)||e.setData({formData:t})}),l.statusChanges.pipe(s.startWith(l.status)).subscribe(function(t){var r=e.validateService.getErrorMsgs(l),o=e.data.errMsgs;n.ObjectUtils.deepCompare(o,r)||e.setData({errMsgs:r})})},t.throttleReselectDept=function(){var e=this;this.departmentSelectService.select().subscribe(function(t){var r=t.id,o=t.name;e.form.patchValue({department:{id:r,name:o}})})},t.throttleReselectProject=function(){var e=this;this.projectSelectService.select().subscribe(function(t){var r=t.id,o=t.name;e.form.patchValue({project:{id:r,name:o}})})},t.throttleConfirm=function(){var e=this.form;n.FormUtils.validate(e)?this.travellerEditService.confirm(e.value):e.updateValueAndValidity()},t.handleInput=function(e){var t=e.currentTarget.dataset.name,r=e.detail.value;this.form.controls[t].markAsDirty(),this.form.patchValue({[t]:r})},t.throttleSelectApproval=function(){var e=this,t=this.data,r=t.startDate,o=t.formData;this.approvalSelectService.select({employeeId:o.employee.id,startDate:r}).subscribe(function(t){var r=t.id,o=t.approvalNo;e.form.patchValue({approvalId:r,approvalNo:o})})},e}();h=o([l.injectable(),i("design:paramtypes",[function(){},p.TravellerEditService,c.DepartmentSelectService,c.ProjectSelectService,a.ValidateService,c.ApprovalSelectService])],h),Page(l.container.resolve(h))},1162:function(e,t,r){"use strict";function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var a=r(8),s=r(6),c=r(0),l=function(){function e(){this.OSSPrefix=s.OSSPrefix}var t,r,i;return t=e,(r=[{key:"isSuccess",get:function(){return"success"===this.result}}])&&o(t.prototype,r),i&&o(t,i),e}(),u=function(){function e(e,t){this.data=e,this.routerService=t}var t=e.prototype;return t.onLoad=function(e){var t=e.result,r=e.orderId,o="success"===t?"支付成功":"支付失败";this.setData({result:t,orderId:r,title:o})},t.throttleToHome=function(){this.routerService.toHome()},t.throttleToOrderDetail=function(){this.routerService.hotel.toOrderDetail(this.data.orderId,!0)},e}();u=i([c.injectable(),n("design:paramtypes",[l,a.RouterService])],u),Page(c.container.resolve(u))},1216:function(e,t,r){"use strict";Component({properties:{value:String},data:{formatValue:""},observers:{value:function(e){if(e){var t=Math.floor(e/60),r=e%60,o=""+(0===t?"":t+"h")+(0!==t&&0===r?"":r+"m");this.setData({formatValue:o})}}}})},1219:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Component({options:{addGlobalClass:!0},properties:{orderDetailProps:{type:Object,observer:function(e){if(e){this.setData({visible:!0,orderDetail:e});var t=e.guests,r=e.returnRecords;this.processFeeInfo(t),r&&r.length&&this.processReturnInfo(r)}}}},data:{visible:!1,orderDetail:null,anyGuest:null,roomCount:0,bookServiceFeeSingle:0,purchaseAgentFeeSingle:0,configBookTrusteeFee:0,configBookTrusteeChargeType:"NotSupported",bookTrusteeFee:0,returnRecordsFeeMix:[],returnFeeAmount:0},lifetimes:{},methods:{throttleClose:function(){this.setData({visible:!1}),this.triggerEvent("close")},processFeeInfo:function(e){var t=e[0],r=e.length,o=t.feeInfo,i=o.bookServiceFee,n=o.purchaseAgentFee,a=o.configBookTrusteeFee,s=o.configBookTrusteeChargeType,c=o.bookTrusteeFee,l=this.toNumber(i),u=this.toNumber(n);this.setData({anyGuest:t,roomCount:r,bookServiceFeeSingle:l,purchaseAgentFeeSingle:u,configBookTrusteeChargeType:s,configBookTrusteeFee:this.toNumber(a),bookTrusteeFee:this.toNumber(c)})},processReturnInfo:function(e){var t=this,r=e.map(function(e){return t.handleReturnRecord(e)}),o=r.map(function(e){return e.total}).reduce(function(e,t){return e+t});this.setData({returnRecordsFeeMix:r,returnFeeAmount:this.toMathAbs(o)})},handleReturnRecord:function(e){var t=e.returnedServiceFee,r=e.returnedTrusteeFee,o=e.returnedRoomFee,i=e.returnedHandingFee,n=e.returnDays,a=e.configReturnTrusteeChargeType,s=e.configReturnTrusteeFee,c=e.createTime,l=this.toNumber(t),u=this.toNumber(o),p=this.toNumber(i),h=this.toNumber(r),f=this.handleReturnDays(n),d=l+h+u+p;return{createTime:c,total:this.toMathAbs(d),returnedServiceFee:l,returnedRoomFee:u,returnedHandingFee:p,returnDays:f,returnedTrusteeFee:h,configReturnTrusteeChargeType:a,configReturnTrusteeFee:s}},handleReturnDays:function(e){var t=[];return e.forEach(function(e){var r=e.begin,o=t.find(function(e){return e.begin===r});o?o.count+=1:t.push(Object.assign({},e,{count:1}))}),t},toNumber:function(e){return e?Number(e):0},toMathAbs:function(e){return Math.abs(e)}}})},1222:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(6);Component({data:{OSSPrefix:o.OSSPrefix,defaultHotelRoomImageUrl:o.OSSPrefix+"/hotel/hotel-room.svg",more:!1,roomVisCount:10,ratePlanVisCount:4,sendOutRoomVis:!1},properties:{group:Object},options:{addGlobalClass:!0},methods:{handleToggleRoomList:function(e){var t=e.currentTarget.dataset.index,r=this.properties.group,o=r.list[t];o.listVisible=!o.listVisible,this.setData({group:r})},handleToggleSendOutRoomList:function(e){var t=e.currentTarget.dataset.index,r=this.properties.group,o=r.sendOutList[t];o.listVisible=!o.listVisible,this.setData({group:r})},throttleOpenRoomDetailPopup:function(e){var t=e.currentTarget.dataset,r=t.room,o=t.rateplan;this.triggerEvent("openRoomDetailPopup",{room:r,rateplan:o})},throttleShowRoomMore:function(e){var t=e.currentTarget.dataset.index,r=this.data.group;r.list[t].more=!0,this.setData({group:r})},throttleShowAll:function(){this.setData({more:!0})},throttleShowSendOut:function(){this.setData({sendOutRoomVis:!0})},throttleBook:function(e){var t=e.currentTarget.dataset,r=t.plancode,o=t.roomcode;this.triggerEvent("book",{plancode:r,roomcode:o})},noop:function(){}}})},1223:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(6);Component({options:{addGlobalClass:!0},properties:{room:Object,ratePlan:Object},data:{defaultHotelRoomImageUrl:o.OSSPrefix+"/hotel/hotel-room.svg",indicatorDots:!0,autoplay:!1,interval:2e3,duration:500},lifetimes:{created:function(){},attached:function(){},ready:function(){},moved:function(){},detached:function(){},error:function(){}},methods:{onLoad:function(){},throttleBook:function(){var e=this.data.ratePlan,t=e.roomCode,r=e.ratePlanCode;this.triggerEvent("book",{plancode:r,roomcode:t})}}})},125:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(807))},1259:function(e,t,r){"use strict";Component({properties:{url:{type:String,value:""}},methods:{handleLinkTap:function(){var e=this.data.url;wx.navigateTo({url:e})}}})},1260:function(e,t,r){"use strict";Component({options:{addGlobalClass:!0},properties:{icon:String}})},1261:function(e,t,r){"use strict";Component({options:{addGlobalClass:!0},properties:{icon:String}})},1262:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(14),i=r(0),n=r(5);Component({properties:{dict:String,code:String},data:{targetValue:""},observers:{code:function(){this.getTargetValue()}},methods:{checkAllDictVersion:function(e){var t=this;i.container.resolve(o.DictHttpService).getCurrentDictVersion().pipe(n.catchError(function(e){throw e})).subscribe(function(r){r!==e&&t.getAllDictForRequest()})},getAllDictForRequest:function(){var e=this;i.container.resolve(o.DictHttpService).getAllDict().pipe(n.catchError(function(e){throw e})).subscribe(function(t){wx.setStorageSync("all-dict-data",t),e.targetValueSetData(t.dictBunch)})},getTargetValue:function(){var e=wx.getStorageSync("all-dict-data");e?this.targetValueSetData(e.dictBunch):this.getAllDictForRequest()},targetValueSetData:function(e){var t=this.properties.dict,r=this.properties.code,o=this.properties.code;if(e[t]){var i=e[t].find(function(e){return e.code===r});i&&(o=i.nameCn),this.setData({targetValue:o})}else this.setData({targetValue:o})}}})},1263:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(6);Component({properties:{value:String,format:{type:String,value:o.dateFormat}},data:{formatValue:""},observers:{value:function(e){var t=this.properties.format;this.setData({formatValue:o.DateUtils.format(e,t)})}}})},1264:function(e,t,r){"use strict";var o;!function(e){e.Mobile="Mobile",e.IdCard="IdCard",e.Other="Other"}(o||(o={}));var i={Mobile:[3,void 0,4],IdCard:[6,void 0,4],Other:[void 0,4,0]};Component({properties:{value:String,encryptType:{type:String,value:o.Other}},data:{encryptValue:""},observers:{value:function(e){var t=e.length;if(e&&t>4){var r=this.properties.encryptType,n=i[r]||i[o.Other],a=n[0],s=n[1],c=n[2];a=a||Math.max(t-s-c,0),s=s||Math.max(t-a-c,0),c=c||Math.max(t-a-s,0);var l=e.substr(0,a),u=e.substr(a,s).replace(/./g,"*"),p=e.substr(a+s,c);this.setData({encryptValue:l+u+p})}else this.setData({encryptValue:e})}}})},1265:function(e,t,r){"use strict";Component({properties:{title:{type:String,value:""}}})},1266:function(e,t,r){"use strict";Component({data:{val:null},properties:{value:{type:String,observer:function(e){e!==this.data.val&&this.setData({val:e})}},type:{type:String},placeholder:{type:String},classNames:{type:String}},methods:{handleInput:function(e){var t=e.detail.value;this.data.val=t,this.triggerEvent("input",e.detail)}}})},1267:function(e,t,r){"use strict";Component({properties:{src:String,defaultSrc:String},methods:{handleLoadError:function(){this.setData({src:this.properties.defaultSrc})}}})},1268:function(e,t,r){"use strict";Component({options:{addGlobalClass:!0},data:{val:null},properties:{value:{type:String,observer:function(e){e!==this.data.val&&this.setData({val:e})}},type:{type:String},placeholder:{type:String},classNames:{type:String}},methods:{handleInput:function(e){var t=e.detail.value;this.data.val=t,this.triggerEvent("input",e.detail)}}})},317:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(36),i=r(32);function n(){var e={brands:[],position:[],tipWordType:[],hotelLevels:[],radius:[],priceRanges:a(),coordinates:s()};return o.fb.group(e)}function a(){return o.fb.array([o.fb.group({priceFrom:[],priceTo:[]})])}function s(){return o.fb.group({lat:[],lon:[]})}t.createForm=function(){var e=i.ThValidators.required,t={checkInDate:[,[e]],checkOutDate:[,[e]],cityCode:[,[e]],keyWord:[],orderBy:[],condition:n(),searchProtocolType:[],travelType:[]};return o.fb.group(t)}},320:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),n=function(){function e(){}var t=e.prototype;return t.toPlaceOrderPage=function(e,t,r,o,i){this.params={requestParams:e,hotel:t,roomCode:r,planCode:o,travelType:i},wx.navigateTo({url:"/app/pages/hotel/place-order/place-order"})},t.getParams=function(){return this.params},e}();n=o([i.singleton()],n),t.HotelPlaceOrderService=n},321:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),n=[["餐厅",["DiningRoom"]],["休闲",["Relaxation"]],["会议室",["MeetingRoom"]],["多功能厅",["MultiFunctionRoom"]],["外观",["Appearance"]],["大堂/接待台",["Lobby"]],["健身/娱乐",["Entertainment"]],["酒廊/酒吧",["Bar"]],["公共区域",["PublicArea"]],["周边景点",["ViewSpot"]],["房间",["Room"]],["其他",["Other"]]],a=function(){function e(){}var t=e.prototype;return t.toPicturePage=function(e,t){this.pictures=t,this.hotelName=e,wx.navigateTo({url:"/app/pages/hotel/detail/pictures/pictures"})},t.getHotelPhotoByType=function(){var e=this,t=[];return n.forEach(function(r){var o=r[0],i=r[1],n=e.pictures.filter(function(e){return i.includes(e.pictureType)});if(n&&n.length>0){var a={photoList:n,pictureTypes:i,cnPictureType:o};t.push(a)}}),{list:t,hotelName:this.hotelName}},e}();a=o([i.singleton()],a),t.PicturesService=a},322:function(e,t,r){"use strict";var o=this&&this.__rest||function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(r[o[i]]=e[o[i]])}return r};Object.defineProperty(t,"__esModule",{value:!0});var i=r(36),n=r(32),a=r(22);t.createHotelPlaceOrderRequestForm=function(e,t){var r=t.wasGreenChannel,o=t.customizeFieldConfig,a=t.creditEnableMixed,s=o.customizeFieldRequired,c=o.useCustomizeField,l=!r&&s&&c,u=!a,p=n.ThValidators,h=p.required,f=p.mobile,d=p.email,v={travelers:i.fb.array([]),specialNotes:[],customizeData:[,l?h:[]],latestArrivalTime:[],contact:i.fb.group({name:[,h],mobile:[,[h,f]],email:[,d]}),needInvoice:[u],invoice:[]},m=i.fb.group(v);return m.patchValue(e),m},t.createHotelBizTravelerForm=function(e){var t=e.projectRequired,r=e.inputApprovalNoEnabled,o=e.approvalRequired,a=n.ThValidators,s=a.required,c={birthday:[],docNo:[],docType:[],gender:[],employee:[],passengerType:["Adult"],travellerType:["Employee"],approvalId:[,o&&!r?s:[]],approvalNo:[,o?s:[]],department:[,s],email:[],mobile:[,a.mobile],overPriceReasonText:[],project:[,t?s:[]],referenceId:[,s]};return i.fb.group(c)},t.getFormValue=function(e){var t=e.value,r=t.invoice,i=t.travelers.map(function(e){var t=e.employee,r=e.project,i=e.department,n=o(e,["employee","project","department"]);return Object.assign({},n,{referenceId:t.id,projectId:r?r.id:null,belongedDeptId:i.id,name:a.getName(t)})}),n=!!r;return Object.assign({},t,{travelers:i,needInvoice:n})}},323:function(e,t,r){"use strict";var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var i=r(16),n=r(0),a=function(){function e(){}var t=e.prototype;return t.edit=function(e,t,r){return this.confirm$=new i.Subject,this.traveller=e,this.policyConfig=t,this.startDate=r,wx.navigateTo({url:"/app/pages/hotel/place-order/traveller-edit/traveller-edit"}),this.confirm$.asObservable()},t.getInfo=function(){return{traveller:this.traveller,policyConfig:this.policyConfig,startDate:this.startDate}},t.confirm=function(e){var t=this;wx.navigateBack(),setTimeout(function(){t.confirm$.next(e),t.confirm$.complete()},0)},e}();a=o([n.singleton()],a),t.TravellerEditService=a},451:function(e,t,r){e.exports=r.p+"app/pages/home/home.json"},452:function(e,t,r){e.exports=r.p+"app/pages/home/home.wxml"},453:function(e,t,r){e.exports=r.p+"app/pages/home/home.wxss"},478:function(e,t,r){e.exports=r.p+"app/pages/hotel/hotel.json"},479:function(e,t,r){e.exports=r.p+"app/pages/hotel/hotel.wxml"},480:function(e,t,r){e.exports=r.p+"app/pages/hotel/hotel.wxss"},481:function(e,t,r){e.exports=r.p+"app/pages/me/me.json"},482:function(e,t,r){e.exports=r.p+"app/pages/me/me.wxml"},483:function(e,t,r){e.exports=r.p+"app/pages/me/me.wxss"},499:function(e,t,r){e.exports=r.p+"app/pages/order-list/order-list.json"},500:function(e,t,r){e.exports=r.p+"app/pages/order-list/order-list.wxml"},501:function(e,t,r){e.exports=r.p+"app/pages/order-list/order-list.wxss"},502:function(e,t,r){e.exports=r.p+"app/pages/hotel-order-detail/hotel-order-detail.json"},503:function(e,t,r){e.exports=r.p+"app/pages/hotel-order-detail/hotel-order-detail.wxml"},504:function(e,t,r){e.exports=r.p+"app/pages/hotel-order-detail/hotel-order-detail.wxss"},505:function(e,t,r){e.exports=r.p+"app/pages/hotel-return/hotel-return.json"},506:function(e,t,r){e.exports=r.p+"app/pages/hotel-return/hotel-return.wxml"},507:function(e,t,r){e.exports=r.p+"app/pages/hotel-return/hotel-return.wxss"},508:function(e,t,r){e.exports=r.p+"app/pages/hotel-untwist-return/hotel-untwist-return.json"},509:function(e,t,r){e.exports=r.p+"app/pages/hotel-untwist-return/hotel-untwist-return.wxml"},510:function(e,t,r){e.exports=r.p+"app/pages/hotel-untwist-return/hotel-untwist-return.wxss"},511:function(e,t,r){e.exports=r.p+"app/pages/hotel/display/display.json"},512:function(e,t,r){e.exports=r.p+"app/pages/hotel/display/display.wxml"},513:function(e,t,r){e.exports=r.p+"app/pages/hotel/display/display.wxss"},514:function(e,t,r){e.exports=r.p+"app/pages/hotel/display/level-explain/level-explain.json"},515:function(e,t,r){e.exports=r.p+"app/pages/hotel/display/level-explain/level-explain.wxml"},516:function(e,t,r){e.exports=r.p+"app/pages/hotel/detail/detail.json"},517:function(e,t,r){e.exports=r.p+"app/pages/hotel/detail/detail.wxml"},518:function(e,t,r){e.exports=r.p+"app/pages/hotel/detail/detail.wxss"},519:function(e,t,r){e.exports=r.p+"app/pages/hotel/detail/pictures/pictures.json"},520:function(e,t,r){e.exports=r.p+"app/pages/hotel/detail/pictures/pictures.wxml"},521:function(e,t,r){e.exports=r.p+"app/pages/hotel/detail/pictures/pictures.wxss"},522:function(e,t,r){e.exports=r.p+"app/pages/hotel/place-order/place-order.json"},523:function(e,t,r){e.exports=r.p+"app/pages/hotel/place-order/place-order.wxml"},524:function(e,t,r){e.exports=r.p+"app/pages/hotel/place-order/place-order.wxss"},525:function(e,t,r){e.exports=r.p+"app/pages/hotel/place-order/traveller-edit/traveller-edit.json"},526:function(e,t,r){e.exports=r.p+"app/pages/hotel/place-order/traveller-edit/traveller-edit.wxml"},527:function(e,t,r){e.exports=r.p+"app/pages/hotel/place-order/traveller-edit/traveller-edit.wxss"},528:function(e,t,r){e.exports=r.p+"app/pages/hotel/pay-result/pay-result.json"},529:function(e,t,r){e.exports=r.p+"app/pages/hotel/pay-result/pay-result.wxml"},530:function(e,t,r){e.exports=r.p+"app/pages/hotel/pay-result/pay-result.wxss"},694:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.environment={serverUrl:"https://test-customer-api-gateway-env-1.teyixing.com"}},807:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(16);function i(e){var t=["ChinaOnline","QianTao","Wjs"];return Array.from(new Set(e.map(function(e){return e.supplier}))).sort(function(e,r){return t.indexOf(e)-t.indexOf(r)})}function n(e){var t="";switch(e){case"ChinaOnline":t="官方直营";break;case"QianTao":t="代理商A";break;case"Wjs":t="代理商B"}return t}function a(e){var t=1/0,r=e.ratePlans.map(function(e){var r=s(e);return r<t&&(t=r),Object.assign({},e,{avgPrice:r})}).sort(function(e,t){return e.avgPrice-t.avgPrice}),o=r[0],i=l(e);return Object.assign({},e,{minPricePlan:o,ratePlans:r,minPrice:t,pictureUrl:i})}function s(e){var t=e.dayPrices.map(function(e){return Number(e.salesAmount)}).reduce(function(e,t){return e+t},0);return Math.ceil(t/e.dayPrices.length)}function c(e){return e.sort(function(e,t){return e.minPrice-t.minPrice})}function l(e,t){var r=e.pictures;return r&&r.length>0?r[0].url:t||""}t.getHotelScoreInfo=function(e){var t="",r="";if(e&&e.comments&&e.comments.point){var o=e.comments.point;t=o+"",o>4.5?r=" 棒极了":o>4&&(r=" 非常棒")}return{scoreDesc:t,extDesc:r}},t.getHotelStars=function(e){var t=["None","TwoOrBelow","Three","Four","Five"],r=[];if(e){var o=t.indexOf(e.hotelLevel||t[0])+1;r=o>0?new Array(Math.floor(o)).fill(!0):new Array(Math.floor(5)).fill(!1)}return r},t.getRoomList=function(e){var t=[],r=[];return e.forEach(function(e){var o=e.ratePlans,i=o.filter(function(e){return!!e.roomCount}),n=o.filter(function(e){return!e.roomCount});if(i.length){var s=a(Object.assign({},e,{ratePlans:i}));t.push(s)}if(n.length){var c=a(Object.assign({},e,{ratePlans:n}));r.push(c)}}),t.length>1&&(t=c(t)),{roomList:t,sendOutRoomList:r}},t.getRoomsGroupedBySupplier=function(e,t){return i(e).map(function(r){var o=e.filter(function(e){return e.supplier===r}),i=t.filter(function(e){return e.supplier===r});return{supplier:r,supplierName:n(r),list:o,sendOutList:i}})},t.getRecommendRooms=function(e){return i(e).map(function(t){var r=e.filter(function(e){return e.supplier===t}).slice(0,2).map(function(e){var t=e.ratePlans,r=[t.find(function(e){return e.hasBreakfast}),t.find(function(e){return!e.hasBreakfast})].filter(function(e){return!!e}).sort(function(e,t){return e.avgPrice-t.avgPrice});return Object.assign({},e,{ratePlans:r,listVisible:!0})});return{supplier:t,supplierName:n(t),list:r}})},t.getSupplierAliasName=n,t.hasRestRoom=function(e){return e.ratePlans.some(function(e){return e.roomCount>0})},t.sortHotelRoomType=a,t.getRoomAvgPrice=s,t.sortHotelRoomList=c,t.getRoomPictureUrl=l,t.getFilterList=function(){return[{title:"床型",type:"bedTypes",selected:!1,activated:!1,data:[{value:"单床",selected:!1},{value:"双床",selected:!1},{value:"大床",selected:!1},{value:"多床",selected:!1},{value:"大/双",selected:!1}]},{title:"早餐",selected:!1,activated:!1,type:"breakfasts",data:[{value:"单早",selected:!1},{value:"双早",selected:!1},{value:"床位早",selected:!1},{value:"无早",selected:!1},{value:"大/双",selected:!1}]},{title:"窗型",selected:!1,activated:!1,type:"windowsTypes",data:[{value:"外窗",selected:!1},{value:"內窗",selected:!1},{value:"无窗",selected:!1},{value:"阳台",selected:!1}]}]};var u=[150,300,450,600,1e3,1e6];t.getPriceItems=function(){return u.map(function(e,t){var r=u[t-1],o=u[t];return{min:r||0,max:o,desc:r?t===u.length-1?"¥ "+r+"以上":"¥ "+r+"-"+o:"¥ "+o+"以下"}})},t.sliderMin=0,t.sliderMax=1e3,t.getPriceRangeDesc=function(e){if(!e)return"";var t=e.condition;if(!t)return"";var r=t.priceRanges;if(!r)return"";var o=r[0],i=o.priceFrom,n=o.priceTo;return null==n?"":n===u[0]?"¥ "+n+"以下":n===u[u.length-1]?"¥ "+i+"以上":"¥ "+i+"-"+n},t.getSliderRangeDesc=function(e,r){return r===u[0]?"¥ "+r+"以下":r===u[u.length-1]?"¥ "+e+"以上":e===t.sliderMin&&r===t.sliderMax?"":"¥ "+e+"-"+r},t.getSliderValue=function(e,r){return e===t.sliderMin&&r===t.sliderMax?[{priceFrom:null,priceTo:null}]:[{priceFrom:e,priceTo:r}]},t.openSetting=function(){return new o.Observable(function(e){wx.showModal({title:"定位失败",content:"请开启定位，为您查询附近酒店",confirmText:"去开启",confirmColor:"#3642ff",success:function(t){t.confirm?wx.openSetting().then(function(t){t.authSetting["scope.userLocation"]&&e.next(),e.complete()}):e.complete()}})})}},810:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),i=function(){function e(e){this.handleErrorService=e,this.st={ps:20,total:1/0,hasNext:!0}}var t=e.prototype;return t._query=function(e){var t=this;this.subscription$&&this.subscription$.unsubscribe(),this.showLoading&&this.showLoading(),this.subscription$=this.httpRequest(e).pipe(o.finalize(function(){t.hideLoading&&t.hideLoading()}),o.catchError(function(e){return t.handleErrorService.handle(e)})).subscribe(function(e){t.processResult&&(e=t.processResult(e));var r=e,o=r.hasNext,i=r.hotels,n=r.total;t.st.total=n,t.st.hasNext=o;var a=t.data.list;a=a?a.concat(i):[].concat(i),t.setData({list:a})})},t.getParams=function(e){var t=this.getQueryParams();return Object.assign({},t,{pageSize:this.st.ps,searchAfter:e})},t.query=function(){var e=this.getParams(null);this.setData({list:null,scrollTop:0}),this._query(e)},t.loadMore=function(){if(this.st.hasNext){var e,t=this.data.list;t&&t.length&&(e=t[t.length-1].sortValues);var r=this.getParams(e);this._query(r)}else wx.showToast({title:"没有更多数据了",icon:"none"})},e}();t.PaginationPage=i},811:function(e,t,r){"use strict";function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0});var i,n,a=r(6),s=r(125),c=s.getPriceItems();!function(e){e.Five="Five",e.Four="Four",e.None="None",e.Three="Three",e.TwoOrBelow="TwoOrBelow"}(i=t.HotelLevel||(t.HotelLevel={})),function(e){e.Default="Default",e.HotelLevel="HotelLevel",e.PriceAsc="PriceAsc",e.PriceDesc="PriceDesc"}(n=t.OrderBy||(t.OrderBy={}));var l=function(){function e(){this.OSSPrefix=a.OSSPrefix,this.calenderVisible=!1,this.formatter=function(e){return"start"===e.type?e.bottomInfo="入住":"end"===e.type&&(e.bottomInfo="离店"),e},this.maxdate=a.DateUtils.addYears(new Date,1).valueOf(),this.options=[{value:n.Default,text:"推荐排序"},{value:n.PriceAsc,text:"低价优先"},{value:n.PriceDesc,text:"高价优先"},{value:n.HotelLevel,text:"高星/钻级优先"}],this.pricePickerVisible=!1,this._minPrice=s.sliderMin,this._maxPrice=s.sliderMax,this.priceItems=c,this.levelOptions=[{value:i.TwoOrBelow,text:"<=两星/钻",tip:"经济"},{value:i.Three,text:"三星/钻",tip:"舒适"},{value:i.Four,text:"四星/钻",tip:"高档"},{value:i.Five,text:"五星/钻",tip:"豪华"}],this.levelsInPopup=[],this.filterList=s.getFilterList(),this.isLoading=!1,this.list=null,this.skeletonList=Array(20).fill(0),this.scrollTop=0,this.hasContractHotel=!1,this.goTopBtnVisible=!1,this.contentHeight=0}var t,r,l;return t=e,(r=[{key:"calendarDefaultDate",get:function(){var e=this.formData;if(!e)return null;var t=e.checkInDate,r=e.checkOutDate;return[new Date(a.DateUtils.format(t)).valueOf(),new Date(a.DateUtils.format(r)).valueOf()]}},{key:"keyword",get:function(){var e=this.formData;if(!e)return"";var t=e.keyWord,r=e.condition;return t||("Poi"===r.tipWordType?r.position:"")}},{key:"orderByDesc",get:function(){var e=this.formData,t=this.options;if(!e)return t[0].text;var r=e.orderBy;return t.find(function(e){return e.value===r}).text}},{key:"orderByHasValue",get:function(){var e=this.formData;return!!e&&e.orderBy!==n.Default}},{key:"priceRangeDescInPopup",get:function(){return s.getSliderRangeDesc(this._minPrice,this._maxPrice)}},{key:"priceRangeDesc",get:function(){var e=this.formData;if(!e)return"";var t=e.condition.hotelLevels;return""+this.levelOptions.filter(function(e){return t.includes(e.value)}).map(function(e){return e.text}).join(",")+s.getPriceRangeDesc(this.formData)}},{key:"priceHasValue",get:function(){return!!this.priceRangeDesc}},{key:"brandStr",get:function(){return this.formData?(this.formData.condition.brands||[]).join(","):""}},{key:"catActivatedChildren",get:function(){return this.cityBaseInfoCats?this.cityBaseInfoCats.find(function(e){return e.activated}).children:null}},{key:"metroStations",get:function(){var e=this.catActivatedChildren;if(!e||!e.length)return null;var t=e.find(function(e){return e.activated});return t&&t.stations||null}},{key:"areaStr",get:function(){var e=this.formData;if(!this.cityBaseInfoCats||!e)return"";var t=e.condition;return t&&"Poi"!==t.tipWordType&&t.position||""}},{key:"onlyAgreement",get:function(){var e=this.formData;return!!e&&"ProtocolPriceOnly"===e.searchProtocolType}},{key:"defaultHotelImageUrl",get:function(){return this.OSSPrefix+"/hotel/hotel.svg"}}])&&o(t.prototype,r),l&&o(t,l),e}();t.HotelDisplayData=l},812:function(e,t,r){"use strict";var o=this&&this.__rest||function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(r[o[i]]=e[o[i]])}return r};Object.defineProperty(t,"__esModule",{value:!0});var i=r(36),n=r(32),a=r(22);t.createHotelPlaceOrderPersonalRequestForm=function(e){var t=n.ThValidators,r=t.required,o=t.mobile,a=t.email,s={travelers:i.fb.array([]),specialNotes:[],latestArrivalTime:[],contact:i.fb.group({name:[,r],mobile:[,[r,o]],email:[,a]}),needInvoice:[!0],invoice:[]},c=i.fb.group(s);return c.patchValue(e),c},t.createHotelPersonalTravelerForm=function(){var e=n.ThValidators,t=e.required,r={birthday:[],docNo:[],docType:[],gender:[],employee:[],passengerType:["Adult"],travellerType:["FrequentTraveller"],email:[],mobile:[,e.mobile],referenceId:[,t]};return i.fb.group(r)},t.getPersonalFormValue=function(e){var t=e.value,r=t.invoice,i=t.travelers.map(function(e){var t=e.employee,r=o(e,["employee"]);return Object.assign({},r,{referenceId:t.id,name:a.getName(t)})}),n=!!r;return Object.assign({},t,{travelers:i,needInvoice:n})}},813:function(e,t,r){"use strict";function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(6),n=r(22),a=["今天","明天","后天"],s=i.DateUtils.format(new Date),c=function(){function e(){this.checkboxIcons={checked:i.OSSPrefix+"/common/checked.svg",unchecked:i.OSSPrefix+"/common/unchecked.svg"},this.feeDetailPopVisible=!1,this.roomDetailPopupVisible=!1,this.travelTypes=n.TravelType,this.roomCountOptions=Array(5).fill(null).map(function(e,t){return t+1}),this.roomCountOptionsVisible=!1,this.OSSPrefix=i.OSSPrefix,this.overPriceReasonText="",this.overrunReasonPopup=!1,this.overrunReasonOption="",this.overrunReasonIsOther=!1,this.overrunOtherReasonContent="",this.latestTimes=["14:00","16:00","18:00","20:00","22:00","00:00"],this.latestTimesPopup=!1,this.serviceFee=0,this.personalTypeDialog=!1,this.bizTypeDialog=!1}var t,r,c;return t=e,(r=[{key:"ratePlan",get:function(){var e=this.room;return e?e.ratePlans[0]:null}},{key:"checkInDateAlias",get:function(){var e=this.roomRequestParams;if(!e)return"";var t=e.checkInDate,r=i.DateUtils.differenceInDays(t,s);return a[r]||i.DateUtils.format(t,i.shortWeekFormat)}},{key:"checkOutDateAlias",get:function(){var e=this.roomRequestParams;if(!e)return"";var t=e.checkOutDate,r=i.DateUtils.differenceInDays(t,s);return a[r]||i.DateUtils.format(t,i.shortWeekFormat)}},{key:"totalDays",get:function(){var e=this.roomRequestParams;if(e){var t=e.checkInDate,r=e.checkOutDate;if(t)return i.DateUtils.differenceInDays(r,t)}return 0}},{key:"isOnBusiness",get:function(){return this.travelType===n.TravelType.OnBusiness}},{key:"travelers",get:function(){var e=this.isOnBusiness?this.formData:this.personalFormData;return e?e.travelers:null}},{key:"roomCount",get:function(){return this.travelers?this.travelers.length:0}},{key:"singleRoomFee",get:function(){var e=this.ratePlan;return e?e.dayPrices.reduce(function(e,t){return e+Number(t.salesAmount)},0):0}},{key:"roomFeeCount",get:function(){return this.singleRoomFee?this.singleRoomFee*this.roomCount:null}},{key:"totalFee",get:function(){var e=this.singleRoomFee,t=this.serviceFee,r=this.roomCount,o=this.totalDays,i=this.trusteeFeeTotal,n=this.ratePlan,a=e*r;return n&&n.protocolCode?a+=i:a+=t*r*o,+a.toFixed(2)}},{key:"trusteeFeeTotal",get:function(){var e=this.roomFeeCount,t=this.trusteeFeeDetail,r=this.totalDays,o=this.roomCount,i=0;if(t){var n=t.chargeType,a=t.trusteeFee;"Percentage"===n&&(i=e?e*(Number(a)/100):0),"RoomNights"===a&&(i=Number(a)*r*o)}return Math.round(i)}}])&&o(t.prototype,r),c&&o(t,c),e}();t.HotelPlaceOrderData=c},916:function(e,t,r){e.exports=r.p+"components/duration/duration.json"},917:function(e,t,r){e.exports=r.p+"components/duration/duration.wxml"},918:function(e,t,r){e.exports=r.p+"components/duration/duration.wxss"},925:function(e,t,r){e.exports=r.p+"app/pages/hotel-order-detail/hotel-order-fee-popup/hotel-order-fee-popup.json"},926:function(e,t,r){e.exports=r.p+"app/pages/hotel-order-detail/hotel-order-fee-popup/hotel-order-fee-popup.wxml"},927:function(e,t,r){e.exports=r.p+"app/pages/hotel-order-detail/hotel-order-fee-popup/hotel-order-fee-popup.wxss"},934:function(e,t,r){e.exports=r.p+"app/pages/hotel/detail/room-list/room-list.json"},935:function(e,t,r){e.exports=r.p+"app/pages/hotel/detail/room-list/room-list.wxml"},936:function(e,t,r){e.exports=r.p+"app/pages/hotel/detail/room-list/room-list.wxss"},937:function(e,t,r){e.exports=r.p+"app/pages/hotel/common/room-detail-popup/index.json"},938:function(e,t,r){e.exports=r.p+"app/pages/hotel/common/room-detail-popup/index.wxml"},939:function(e,t,r){e.exports=r.p+"app/pages/hotel/common/room-detail-popup/index.wxss"}};